<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MyBatis02 | Reddes的个人博客</title><meta name="description" content="输入映射和输出映射Mapper.xml映射文件中定义了操作数据库的sql,每个sql是一个statement, 映射文件是mybatis的核心。 环境准备1.复制昨天的工程，按照下图进行   2.如下图粘贴，并更名   3.只保留Mapper接口开发相关的文件，其他的删除 最终效果如下图：  4.如下图修改SqlMapConfig.xml配置文件。Mapper映射器只保留包扫描的方式  param"><meta name="keywords" content="MyBatis-2"><meta name="author" content="Reddes"><meta name="copyright" content="Reddes"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MyBatis02"><meta name="twitter:description" content="输入映射和输出映射Mapper.xml映射文件中定义了操作数据库的sql,每个sql是一个statement, 映射文件是mybatis的核心。 环境准备1.复制昨天的工程，按照下图进行   2.如下图粘贴，并更名   3.只保留Mapper接口开发相关的文件，其他的删除 最终效果如下图：  4.如下图修改SqlMapConfig.xml配置文件。Mapper映射器只保留包扫描的方式  param"><meta name="twitter:image" content="http://reddescode.github.io/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="MyBatis02"><meta property="og:url" content="http://reddescode.github.io/2019/09/17/MyBatis02/"><meta property="og:site_name" content="Reddes的个人博客"><meta property="og:description" content="输入映射和输出映射Mapper.xml映射文件中定义了操作数据库的sql,每个sql是一个statement, 映射文件是mybatis的核心。 环境准备1.复制昨天的工程，按照下图进行   2.如下图粘贴，并更名   3.只保留Mapper接口开发相关的文件，其他的删除 最终效果如下图：  4.如下图修改SqlMapConfig.xml配置文件。Mapper映射器只保留包扫描的方式  param"><meta property="og:image" content="http://reddescode.github.io/img/post.jpg"><meta property="article:published_time" content="2019-09-17T12:45:00.000Z"><meta property="article:modified_time" content="2020-04-26T15:17:13.134Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://reddescode.github.io/2019/09/17/MyBatis02/"><link rel="prev" title="MyBatis01" href="http://reddescode.github.io/2019/09/17/MyBatis01/"><link rel="next" title="Eclipse集成tomcat并发布Javaweb应用" href="http://reddescode.github.io/2019/09/17/Eclipse%E9%9B%86%E6%88%90tomcat%E5%B9%B6%E5%8F%91%E5%B8%83Javaweb%E5%BA%94%E7%94%A8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">332</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">80</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">47</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#输入映射和输出映射"><span class="toc-number">1.</span> <span class="toc-text">输入映射和输出映射</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#环境准备"><span class="toc-number">1.1.</span> <span class="toc-text">环境准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parameterType（输入类型）"><span class="toc-number">1.2.</span> <span class="toc-text">parameterType（输入类型）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#传送简单类型"><span class="toc-number">1.2.1.</span> <span class="toc-text">传送简单类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#传递pojo对象"><span class="toc-number">1.2.2.</span> <span class="toc-text">传递pojo对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#传递pojo包装对象"><span class="toc-number">1.2.3.</span> <span class="toc-text">传递pojo包装对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#编写-QueryVo"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">编写 QueryVo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sql-语句"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">Sql 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-xml文件"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">Mapper.xml文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-接口"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法"><span class="toc-number">1.2.3.5.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果"><span class="toc-number">1.2.3.6.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#resultType-输出类型"><span class="toc-number">1.3.</span> <span class="toc-text">resultType(输出类型)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#输出简单类型"><span class="toc-number">1.3.1.</span> <span class="toc-text">输出简单类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-xml-文件"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Mapper.xml 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-接口-1"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法-1"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-1"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输出pojo对象"><span class="toc-number">1.3.2.</span> <span class="toc-text">输出pojo对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输出pojo列表"><span class="toc-number">1.3.3.</span> <span class="toc-text">输出pojo列表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#resultMap"><span class="toc-number">1.4.</span> <span class="toc-text">resultMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#声明pojo对象"><span class="toc-number">1.4.1.</span> <span class="toc-text">声明pojo对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-xml-文件-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">Mapper.xml 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-接口-2"><span class="toc-number">1.4.3.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试方法-2"><span class="toc-number">1.4.4.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-2"><span class="toc-number">1.4.5.</span> <span class="toc-text">效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-resultMap"><span class="toc-number">1.4.6.</span> <span class="toc-text">使用 resultMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-3"><span class="toc-number">1.4.7.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#动态sql"><span class="toc-number">2.</span> <span class="toc-text">动态sql</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#If标签"><span class="toc-number">2.1.</span> <span class="toc-text">If标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-xml-文件-2"><span class="toc-number">2.1.1.</span> <span class="toc-text">Mapper.xml 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-接口-3"><span class="toc-number">2.1.2.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试方法-3"><span class="toc-number">2.1.3.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-4"><span class="toc-number">2.1.4.</span> <span class="toc-text">效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用if标签"><span class="toc-number">2.1.5.</span> <span class="toc-text">使用if标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-5"><span class="toc-number">2.1.6.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Where标签"><span class="toc-number">2.2.</span> <span class="toc-text">Where标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-6"><span class="toc-number">2.2.1.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sql-片段"><span class="toc-number">2.3.</span> <span class="toc-text">Sql 片段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#foreach-标签"><span class="toc-number">2.4.</span> <span class="toc-text">foreach 标签</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#改造-QueryVo"><span class="toc-number">2.4.1.</span> <span class="toc-text">改造 QueryVo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-xml-文件-3"><span class="toc-number">2.4.2.</span> <span class="toc-text">Mapper.xml 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-7"><span class="toc-number">2.4.3.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关联查询"><span class="toc-number">3.</span> <span class="toc-text">关联查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#商品订单数据模型"><span class="toc-number">3.1.</span> <span class="toc-text">商品订单数据模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一对一查询"><span class="toc-number">3.2.</span> <span class="toc-text">一对一查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方法一：使用-resultType"><span class="toc-number">3.2.1.</span> <span class="toc-text">方法一：使用 resultType</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#改造-pojo-类"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">改造 pojo 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-xml"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">Mapper.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-接口-4"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法-4"><span class="toc-number">3.2.1.4.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-8"><span class="toc-number">3.2.1.5.</span> <span class="toc-text">效果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#小结"><span class="toc-number">3.2.1.6.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法二：使用-resultMap"><span class="toc-number">3.2.2.</span> <span class="toc-text">方法二：使用 resultMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#改造-pojo-类-1"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">改造 pojo 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-xml-1"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">Mapper.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mapper-接口-5"><span class="toc-number">3.2.2.3.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法-5"><span class="toc-number">3.2.2.4.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-9"><span class="toc-number">3.2.2.5.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一对多查询"><span class="toc-number">3.3.</span> <span class="toc-text">一对多查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改-pojo-类"><span class="toc-number">3.3.1.</span> <span class="toc-text">修改 pojo 类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-xml-2"><span class="toc-number">3.3.2.</span> <span class="toc-text">Mapper.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-接口-6"><span class="toc-number">3.3.3.</span> <span class="toc-text">Mapper 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试方法-6"><span class="toc-number">3.3.4.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-10"><span class="toc-number">3.3.5.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis-整合-spring"><span class="toc-number">4.</span> <span class="toc-text">Mybatis 整合 spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#整合思路"><span class="toc-number">4.1.</span> <span class="toc-text">整合思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#整合需要的jar包"><span class="toc-number">4.2.</span> <span class="toc-text">整合需要的jar包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#整合的步骤"><span class="toc-number">4.3.</span> <span class="toc-text">整合的步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建工程"><span class="toc-number">4.3.1.</span> <span class="toc-text">创建工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入jar包"><span class="toc-number">4.3.2.</span> <span class="toc-text">导入jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入配置文件"><span class="toc-number">4.3.3.</span> <span class="toc-text">加入配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SqlMapConfig-xml"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">SqlMapConfig.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#applicationContext-xml"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">applicationContext.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#db-properties"><span class="toc-number">4.3.3.3.</span> <span class="toc-text">db.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Iog4j-properties"><span class="toc-number">4.3.3.4.</span> <span class="toc-text">Iog4j.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-11"><span class="toc-number">4.3.3.5.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dao的开发"><span class="toc-number">4.4.</span> <span class="toc-text">Dao的开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建-pojo"><span class="toc-number">4.4.1.</span> <span class="toc-text">创建 pojo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#传统dao的开发方式"><span class="toc-number">4.4.2.</span> <span class="toc-text">传统dao的开发方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#实现-Mapper-xml"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">实现 Mapper.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加载-Mapper-xml"><span class="toc-number">4.4.2.2.</span> <span class="toc-text">加载 Mapper.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实现-UserDao-接口"><span class="toc-number">4.4.2.3.</span> <span class="toc-text">实现 UserDao 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实现-UserDaoImpI-实现类"><span class="toc-number">4.4.2.4.</span> <span class="toc-text">实现 UserDaoImpI 实现类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置-dao"><span class="toc-number">4.4.2.5.</span> <span class="toc-text">配置 dao</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法-7"><span class="toc-number">4.4.2.6.</span> <span class="toc-text">测试方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper代理形式开发dao"><span class="toc-number">4.4.3.</span> <span class="toc-text">Mapper代理形式开发dao</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#实现-Mapper-xml-1"><span class="toc-number">4.4.3.1.</span> <span class="toc-text">实现 Mapper.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#实现-UserMapper-接口"><span class="toc-number">4.4.3.2.</span> <span class="toc-text">实现 UserMapper 接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方式一：配置mapper代理"><span class="toc-number">4.4.3.3.</span> <span class="toc-text">方式一：配置mapper代理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试方法-8"><span class="toc-number">4.4.3.4.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方式二：扫描包形式配置mapper"><span class="toc-number">4.4.3.5.</span> <span class="toc-text">方式二：扫描包形式配置mapper</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis逆向工程"><span class="toc-number">5.</span> <span class="toc-text">Mybatis逆向工程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#导入逆向工程"><span class="toc-number">5.1.</span> <span class="toc-text">导入逆向工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#复制逆向工程到工作空间中"><span class="toc-number">5.1.1.</span> <span class="toc-text">复制逆向工程到工作空间中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入逆向工程到eclipse中"><span class="toc-number">5.1.2.</span> <span class="toc-text">导入逆向工程到eclipse中</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改配置文件"><span class="toc-number">5.2.</span> <span class="toc-text">修改配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生成逆向工程代码"><span class="toc-number">5.3.</span> <span class="toc-text">生成逆向工程代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试逆向工程代码"><span class="toc-number">5.4.</span> <span class="toc-text">测试逆向工程代码</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Reddes的个人博客</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MyBatis02</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-17 20:45:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-04-26 23:17:13"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-26</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/">IT</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/">Java</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/">JavaEE</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/%E6%A1%86%E6%9E%B6/">框架</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/%E6%A1%86%E6%9E%B6/MyBatis02/">MyBatis02</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="输入映射和输出映射"><a href="#输入映射和输出映射" class="headerlink" title="输入映射和输出映射"></a>输入映射和输出映射</h1><p>Mapper.xml映射文件中定义了操作数据库的sql,每个sql是一个statement, 映射文件是mybatis的核心。</p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>1.复制昨天的工程，按照下图进行</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps1.png"  alt="img"> </p>
<p>2.如下图粘贴，并更名</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps2.png"  alt="img"> </p>
<p>3.只保留Mapper接口开发相关的文件，其他的删除 最终效果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568984591962.png"  alt="1568984591962"></p>
<p>4.如下图修改SqlMapConfig.xml配置文件。Mapper映射器只保留包扫描的方式</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568984659831.png"  alt="1568984659831"></p>
<h2 id="parameterType（输入类型）"><a href="#parameterType（输入类型）" class="headerlink" title="parameterType（输入类型）"></a><strong>parameterType（</strong>输入类型）</h2><h3 id="传送简单类型"><a href="#传送简单类型" class="headerlink" title="传送简单类型"></a>传送简单类型</h3><p>参考第一天内容。</p>
<p>使用#{}估位符，或者${}进行sql拼接。</p>
<h3 id="传递pojo对象"><a href="#传递pojo对象" class="headerlink" title="传递pojo对象"></a>传递pojo对象</h3><p>参考第一天的内容。</p>
<p>Mybatis使用ognl表达式解析对象字段的值，#｛｝或者$｛｝括号中的值为pojo属性 名称。</p>
<h3 id="传递pojo包装对象"><a href="#传递pojo包装对象" class="headerlink" title="传递pojo包装对象"></a>传递<strong>pojo</strong>包装对象</h3><p>开发中通过可以使用pojo传递查询条件。</p>
<p>查询条件可能是综合的查询条件，不仅包括用户查询条件还包括其它的查询 条件（比如查询用户信息的时候，将用户购买商品信息也作为查询条件），这时 可以使用包装对象传递输入参数。</p>
<p>包装对象：Pojo类中的一个属性是另外一个pojo。</p>
<p>需求：根据用户名模糊查询用户信息，查询条件放到QueryVo的user属性中。</p>
<h4 id="编写-QueryVo"><a href="#编写-QueryVo" class="headerlink" title="编写 QueryVo"></a>编写 <strong>QueryVo</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line">    <span class="comment">//包含其他的pojo</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getuser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> user ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Sql-语句"><a href="#Sql-语句" class="headerlink" title="Sql 语句"></a><strong>Sql</strong> 语句</h4><p>SELECT * FROM user WHERE username LIKE ‘％张％‘</p>
<h4 id="Mapper-xml文件"><a href="#Mapper-xml文件" class="headerlink" title="Mapper.xml文件"></a>Mapper.xml文件</h4><p>在UserMapper.xml中配置sql,如下图。</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568984959066.png"  alt="1568984959066"></p>
<h4 id="Mapper-接口"><a href="#Mapper-接口" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h4><p>在UserMapper接口中添加方法，如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985007656.png"  alt="1568985007656"></p>
<h4 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h4><p>在UserMapeprTest增加测试方法，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryuserByQueryVo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">//使用userMapper执行查询，使用包装对象</span></span><br><span class="line">    QueryVo queryVo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">    <span class="comment">//设置user条件</span></span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setusername(<span class="string">"张"</span>);</span><br><span class="line">    <span class="comment">//设置到包装对象中</span></span><br><span class="line">    queryVo.setUser(user);</span><br><span class="line">    <span class="comment">//执行查询</span></span><br><span class="line">    List&lt;User&gt; list = userMapper.queryUserByQueryVo(queryVo);</span><br><span class="line">    <span class="keyword">for</span>(User u : list) &#123;</span><br><span class="line">    	System.out.println(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p>测试结果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985210454.png"  alt="1568985210454"></p>
<h2 id="resultType-输出类型"><a href="#resultType-输出类型" class="headerlink" title="resultType(输出类型)"></a><strong>resultType(</strong>输出类型)</h2><h3 id="输出简单类型"><a href="#输出简单类型" class="headerlink" title="输出简单类型"></a>输出简单类型</h3><p>需求:查询用户表数据条数</p>
<p>sql： SELECT count(*) FROM ‘user’</p>
<h4 id="Mapper-xml-文件"><a href="#Mapper-xml-文件" class="headerlink" title="Mapper.xml 文件"></a><strong>Mapper.xml</strong> 文件</h4><p>在UserMapper.xml中配置sql,如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985337492.png"  alt="1568985337492"></p>
<h4 id="Mapper-接口-1"><a href="#Mapper-接口-1" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h4><p>在UserMapper添加方法，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985363912.png"  alt="1568985363912"></p>
<h4 id="测试方法-1"><a href="#测试方法-1" class="headerlink" title="测试方法"></a>测试方法</h4><p>在UserMapeprTest增加测试方法，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">//使用userMapper执行查询用户数据条数</span></span><br><span class="line">    <span class="keyword">int</span> count = userMapper.queryUserCount();</span><br><span class="line">    System.out.println(count);</span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果-1"><a href="#效果-1" class="headerlink" title="效果"></a>效果</h4><p>测试结果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985479178.png"  alt="1568985479178"></p>
<p>注意：输岀简单类型必须查询出来的结果集有一条记录，最终将第一个字段的值转换为输岀类型。</p>
<h3 id="输出pojo对象"><a href="#输出pojo对象" class="headerlink" title="输出pojo对象"></a>输出<strong>pojo</strong>对象</h3><p>参考第一天内容</p>
<h3 id="输出pojo列表"><a href="#输出pojo列表" class="headerlink" title="输出pojo列表"></a>输出<strong>pojo</strong>列表</h3><p>参考第一天内容。</p>
<h2 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap"></a><strong>resultMap</strong></h2><p>resultType可以指定将查询结果映射为pojo，但需要pojo的属性名和sql查 询的列名一致方可映射成功。</p>
<p>如果sql查询字段名和pojo的属性名不一致，可以通过resultMap将字段名 和属性名作一个对应关系，resultMap实质上还需要将查询结果映射到pojo对象中。</p>
<p>resultMap可以实现将查询结果映射为复杂类型的pojo，比如在查询结果映射对象中包括pojo和list实现一对一查询和一对多查询。</p>
<p>需求：查询订单表order的所有数据</p>
<p>sql： SELECT id, user_id, number, createtime, note FROM ‘order’</p>
<h3 id="声明pojo对象"><a href="#声明pojo对象" class="headerlink" title="声明pojo对象"></a><strong>声明</strong>pojo对象</h3><p>数据库表如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568985649077.png"  alt="1568985649077"></p>
<p>Order对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="comment">//订单id </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="comment">//用户id</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="comment">//订单号</span></span><br><span class="line">    <span class="keyword">private</span> String number;</span><br><span class="line">    <span class="comment">//订单创建时间</span></span><br><span class="line">    <span class="keyword">private</span> Date createt ime;</span><br><span class="line">    <span class="comment">//备注</span></span><br><span class="line">    <span class="keyword">private</span> String note;</span><br><span class="line">    </span><br><span class="line">    get/set...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Mapper-xml-文件-1"><a href="#Mapper-xml-文件-1" class="headerlink" title="Mapper.xml 文件"></a><strong>Mapper.xml</strong> 文件</h3><p>创建OrderMapper.xml配置文件，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace:命名空间，用于隔离sql,还有一个很重要的作用，Mapper动态代</span></span><br><span class="line"><span class="comment">理开发的时候使用，需要指定Mapper的类路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"cn.itcast.mybatis.mapper.OrderMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--查询所有的订单数据--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryorderAll"</span> <span class="attr">resultType</span>=<span class="string">"order"</span>&gt;</span></span><br><span class="line">        SELECT id, user_id,</span><br><span class="line">        number,</span><br><span class="line">        createtime, note FROM `order`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Mapper-接口-2"><a href="#Mapper-接口-2" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h3><p>编写接口如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *查询所有订单</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">List&lt;Order&gt; <span class="title">queryOrderA1l</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="测试方法-2"><a href="#测试方法-2" class="headerlink" title="测试方法"></a>测试方法</h3><p>编写测试方法OrderMapperTest如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderMapperTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Sq1SessionFactory sqlSessionFactory;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream( <span class="string">"Sq1MapConfig.xm1"</span>);</span><br><span class="line">        <span class="keyword">this</span>.sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取sqlSession</span></span><br><span class="line">        sqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">        <span class="comment">//获取OrderMapper</span></span><br><span class="line">        OrderMapper orderMapper =</span><br><span class="line">        sqlSession.getMapper(OrderMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="number">1</span>/执行查询</span><br><span class="line">        List&lt;Order&gt; list = orderMapper.queryOrderAll();</span><br><span class="line">        <span class="keyword">for</span> (Order order : list) &#123;</span><br><span class="line">        System.out.println(order);</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-2"><a href="#效果-2" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568986464613.png"  alt="1568986464613"></p>
<p>发现 userId 为 null</p>
<p>解决方案：使用resultMap</p>
<h3 id="使用-resultMap"><a href="#使用-resultMap" class="headerlink" title="使用 resultMap"></a>使用 <strong>resultMap</strong></h3><p>由于上边的mapper.xml中sql查询列(user_id)和Order类属性(userid)不一致，所 以查询结果不能映射到pojo中。</p>
<p>需要定义 resultMap,把 orderResultMap 将 sql 查询列(user_id)和 Order 类属性 (userId)对应起来</p>
<p>改造 0rderMapper.xml,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version= "1.0" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace:命名空间，用于隔离sql,还有一个很重要的作用，Mapper动态代理开发的时候使用，需要指定Mapper的类路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"cn.itcast.mybatis.mapper.OrderMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- resultMap最终还是要将结果映射到pojo上，type就是指定映射到哪一个pojo --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- id:设置ResultMap的id --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"order"</span> <span class="attr">id</span>=<span class="string">"orderResultMop"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--定义主键,非常重要。如果是多个字段,则定义多个id --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- property: 主键在pojo中的属性名--</span></span><br><span class="line"><span class="comment">        &lt;!-- column:主键在数据库中的列名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">colum</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!--定义普通属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"userId"</span> <span class="attr">column</span>= <span class="string">"user_id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"number"</span> <span class="attr">column</span>= <span class="string">"number"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"createtime"</span> <span class="attr">column</span>= <span class="string">"createtime"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"note"</span> <span class="attr">column</span>= <span class="string">"note"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--查询所有的订单数据--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryOrderAll"</span> <span class="attr">resultMap</span>=<span class="string">"orderResultMap"</span>&gt;</span></span><br><span class="line">        SELECT id, user_id,</span><br><span class="line">        number,</span><br><span class="line">        createtime,note FROM `order`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="效果-3"><a href="#效果-3" class="headerlink" title="效果"></a>效果</h3><p>只需要修改<strong>Mapper.xml</strong>就可以了，再次测试结果如下:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568987196578.png"  alt="1568987196578"></p>
<h1 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态<strong>sql</strong></h1><p>通过<strong>mybatis</strong>提供的各种标签方法实现动态拼接<strong>sql</strong>。</p>
<p>需求：根据性别和名字查询用户</p>
<p>查询sql：</p>
<p><strong>SELECT id, username, birthday, sex, address FROM ‘user’ WHERE sex = 1 AND username LIKE</strong> ‘％张％‘</p>
<h2 id="If标签"><a href="#If标签" class="headerlink" title="If标签"></a><strong>If</strong>标签</h2><h3 id="Mapper-xml-文件-2"><a href="#Mapper-xml-文件-2" class="headerlink" title="Mapper.xml 文件"></a><strong>Mapper.xml</strong> 文件</h3><p><strong>UserMapper.xml</strong> 配置 <strong>sql,</strong>如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据条件查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByWhere"</span> <span class="attr">parameterType</span>= <span class="string">"user"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">    SELECT id, username, birthday, sex, address FROM `user`</span><br><span class="line">    WHERE sex = #&#123;sex&#125; AND username LIKE</span><br><span class="line">    '%$&#123;username&#125;%'</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Mapper-接口-3"><a href="#Mapper-接口-3" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h3><p>编写Mapper接口，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568987495500.png"  alt="1568987495500"></p>
<h3 id="测试方法-3"><a href="#测试方法-3" class="headerlink" title="测试方法"></a>测试方法</h3><p>在UserMapperTest添加测试方法，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryuserByWhere</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用userMapper执行根据条件查询用户</span></span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setSex(<span class="string">"1"</span>);</span><br><span class="line">    user.setusername(<span class="string">"张"</span>);</span><br><span class="line">    </span><br><span class="line">    List&lt;User&gt; list = userMapper.queryUserByWhere(user);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (User u: list) &#123;</span><br><span class="line">    	System.out.println(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-4"><a href="#效果-4" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568987643430.png"  alt="1568987643430"></p>
<p>如果注释掉user.setSex(nlN),测试结果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568987687711.png"  alt="1568987687711"></p>
<p>测试结果二很显然不合理。</p>
<p>按照之前所学的，要解决这个问题，需要编写多个<strong>sql,</strong>查询条件越多，需要编 写的<strong>sql</strong>就更多了，显然这样是不靠谱的。</p>
<p>解决方案，使用动态<strong>sql</strong>的<strong>if</strong>标签</p>
<h3 id="使用if标签"><a href="#使用if标签" class="headerlink" title="使用if标签"></a>使用<strong>if</strong>标签</h3><p>改造 <strong>UserMapper.xmb</strong> 如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据条件查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByWhere"</span> <span class="attr">parameterType</span>= <span class="string">"user"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">    SELECT id, username, birthday, sex, address FROM `user`</span><br><span class="line">    WHERE 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null and sex !=''"</span>&gt;</span></span><br><span class="line">    	AND sex = #&#123;sex&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != null and username !=''"</span>&gt;</span></span><br><span class="line">        AND username LIKE</span><br><span class="line">        '%$&#123;username&#125;%'</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意字符串类型的数据需要要做不等于空字符串校验。</p>
<h3 id="效果-5"><a href="#效果-5" class="headerlink" title="效果"></a>效果</h3><p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568988062817.png"  alt="1568988062817"></p>
<p>如上图所示，测试OK</p>
<h2 id="Where标签"><a href="#Where标签" class="headerlink" title="Where标签"></a>Where标签</h2><p>上面的sql还有where 1=1这样的语句，很麻烦</p>
<p>可以使用where标签进行改造</p>
<p>改造UserMapper.xml,如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据条件查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByWhere"</span> <span class="attr">parameterType</span>= <span class="string">"user"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">    SELECT id, username, birthday, sex, address FROM `user`</span><br><span class="line">    <span class="comment">&lt;!--where标签可以自动添加where,同时处理sql语句中第一个and关键字--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null"</span>&gt;</span></span><br><span class="line">        	AND sex = #&#123;sex&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>= <span class="string">"username != null and username != ''"</span>&gt;</span></span><br><span class="line">            AND username LIKE</span><br><span class="line">            '%$&#123;username&#125;%'</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="效果-6"><a href="#效果-6" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568988384421.png"  alt="1568988384421"></p>
<h2 id="Sql-片段"><a href="#Sql-片段" class="headerlink" title="Sql 片段"></a><strong>Sql</strong> 片段</h2><p>Sql中可将重复的sql提取出来，使用时用include引用即可，最终达到sql重用的目的。</p>
<p>把上面例子中的id, username, birthday, sex, address提取出来，作为sql 片段，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据条件查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByWhere"</span> <span class="attr">parameterType</span>= <span class="string">"user"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SELECT id, username, birthday, sex, address FROM `user` --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--使用include标签加载sql片段: refid 是sql片段id --&gt;</span></span><br><span class="line">SELECT <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>= <span class="string">"userFields"</span> /&gt;</span> FROM `user`</span><br><span class="line"><span class="comment">&lt;!-- where标签可以自动添加where关键字，同时处理sql语句中第一个and关键字--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"sex != null"</span>&gt;</span></span><br><span class="line">    	AND sex = #&#123;sex&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>= <span class="string">"username != null and username != ' '"</span>&gt;</span></span><br><span class="line">        AND username LIKE</span><br><span class="line">        '%$ &#123;username &#125;%'</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 声明sql片段--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>= <span class="string">"userFields"</span>&gt;</span></span><br><span class="line">	id, username, birthday, sex, address</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果要使用别的Mapper.xml配置的sql片段，可以在refid前面加上对应的Mapper.xml的namespace<br>例如下图</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568988856981.png"  alt="1568988856981"></p>
<h2 id="foreach-标签"><a href="#foreach-标签" class="headerlink" title="foreach 标签"></a><strong>foreach</strong> 标签</h2><p>向sql传递数组或List, mybatis使用foreach解析，如下:</p>
<p>根据多个id查询用户信息</p>
<p>查询sql：</p>
<p>SELECT * FROM user WHERE id IN (1,10,24)</p>
<h3 id="改造-QueryVo"><a href="#改造-QueryVo" class="headerlink" title="改造 QueryVo"></a>改造 <strong>QueryVo</strong></h3><p>如下图在pojo中定义list属性ids存储多个用户id,并添加getter/setter方法</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568988912666.png"  alt="1568988912666"></p>
<h3 id="Mapper-xml-文件-3"><a href="#Mapper-xml-文件-3" class="headerlink" title="Mapper.xml 文件"></a><strong>Mapper.xml</strong> 文件</h3><p>UserMapper.xml 添加 sql,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据ids查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserByIds"</span> <span class="attr">parameterType</span>= <span class="string">"queryVo"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">    SELECT * FROM `user`</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- foreach标签，进行遍历--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- collection: 遍历的集合，这里是QueryVo的ids属性--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- item: 遍历的项目，可以随便写..但是和后面的#&#123;里面要致--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- open: 在前面添加的sq1片段--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- close: 在结尾处添加的sql片段--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- separator: 指定遍历的元素之间使用的分隔符--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"ids"</span> <span class="attr">item</span>= <span class="string">"item"</span> <span class="attr">open</span>=<span class="string">"id IN ("</span><span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">        	#&#123;item&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试方法如下图：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用userMapper执行根据条件查询用户</span></span><br><span class="line">    QueryVo queryVo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">    List&lt;Integer&gt; ids = <span class="keyword">new</span> Arraylist&lt;&gt;();</span><br><span class="line">    ids.add(<span class="number">1</span>);</span><br><span class="line">    ids.add(<span class="number">10</span>);</span><br><span class="line">    ids.add(<span class="number">24</span>);</span><br><span class="line">    queryVo.setIds(ids);</span><br><span class="line">    </span><br><span class="line">    List&lt;User&gt; list = userMapper.queryUserByIds(queryVo);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (User u : list) &#123;</span><br><span class="line">    	System. out. println(u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-7"><a href="#效果-7" class="headerlink" title="效果"></a>效果</h3><p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568989372053.png"  alt="1568989372053"></p>
<h1 id="关联查询"><a href="#关联查询" class="headerlink" title="关联查询"></a>关联查询</h1><h2 id="商品订单数据模型"><a href="#商品订单数据模型" class="headerlink" title="商品订单数据模型"></a>商品订单数据模型</h2><p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps34.png"  alt="img"> </p>
<h2 id="一对一查询"><a href="#一对一查询" class="headerlink" title="一对一查询"></a>一对一查询</h2><p>需求：查询所有订单信息，关联查询下单用户信息。</p>
<p>注意：因为一个订单信息只会是一个人下的订单，所以从查询订单信息岀发关联查询用户信息为一对一查询。如果从用户信息出发查询用户下的订单信息则为一对多查询，因为一个用户可以下多个订单。</p>
<p>sql语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    o.id,</span><br><span class="line">    o.user_id userId,</span><br><span class="line">    o.number,</span><br><span class="line">    o.createtime,</span><br><span class="line">    o.note,</span><br><span class="line">    u.username,</span><br><span class="line">    u.address</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	<span class="string">`order`</span></span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="string">`user`</span> u <span class="keyword">ON</span> o.user_id= u.id</span><br></pre></td></tr></table></figure>

<h3 id="方法一：使用-resultType"><a href="#方法一：使用-resultType" class="headerlink" title="方法一：使用 resultType"></a>方法一：使用 <strong>resultType</strong></h3><p>使用resultType，改造订单pojo类，此pojo类中包括了订单信息和用户信息。这样返回对象的时候，mybatis自动把用户信息也注入进来了</p>
<h4 id="改造-pojo-类"><a href="#改造-pojo-类" class="headerlink" title="改造 pojo 类"></a>改造 <strong>pojo</strong> 类</h4><p>OrderUser类继承Order类后OrderUser类包括了 Order类的所有字段，只需要定</p>
<p>义用户的信息字段即可，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568989579827.png"  alt="1568989579827"></p>
<h4 id="Mapper-xml"><a href="#Mapper-xml" class="headerlink" title="Mapper.xml"></a><strong>Mapper.xml</strong></h4><p>在 UserMapper.xml 添加 sql,如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查询订单，同时包含用户数据--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryOrderUser"</span> <span class="attr">resultType</span>= <span class="string">"orderUser"</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    o.id,</span><br><span class="line">    o.user_id,</span><br><span class="line">    userId,</span><br><span class="line">    o.number,</span><br><span class="line">    o.createtime,</span><br><span class="line">    o.note,</span><br><span class="line">    u.username,</span><br><span class="line">    u.address</span><br><span class="line">    FROM </span><br><span class="line">    order o</span><br><span class="line">    LEFT JOIN `user` ON o.user_id = u.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Mapper-接口-4"><a href="#Mapper-接口-4" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h4><p>在UserMapper接口添加方法，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568989738166.png"  alt="1568989738166"></p>
<h4 id="测试方法-4"><a href="#测试方法-4" class="headerlink" title="测试方法"></a>测试方法</h4><p>在UserMapperTest添加测试方法，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryOrderUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">//使用userMapper执行根据条件查询用户</span></span><br><span class="line">    List&lt;orderUser&gt; list = userMapper.queryOrderUser();</span><br><span class="line">    <span class="keyword">for</span> (OrderUser ou : list) &#123;</span><br><span class="line">    	System.out.println(ou);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果-8"><a href="#效果-8" class="headerlink" title="效果"></a>效果</h4><p>测试结果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568989847657.png"  alt="1568989847657"></p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>定义专门的pojo类作为输出类型，其中定义了 sql查询结果集所有的字段。 此方法较为简单，企业中使用普遍。</p>
<h3 id="方法二：使用-resultMap"><a href="#方法二：使用-resultMap" class="headerlink" title="方法二：使用 resultMap"></a>方法二：使用 <strong>resultMap</strong></h3><p>使用resultMap,定义专门的resultMap用于映射一对一查询结果。</p>
<h4 id="改造-pojo-类-1"><a href="#改造-pojo-类-1" class="headerlink" title="改造 pojo 类"></a>改造 <strong>pojo</strong> 类</h4><p>在Order类中加入User属性，user属性中用于存储关联查询的用户信息，因 为订单关联查询用户是一对一关系，所以这里使用单个User对象存储关联查询 的用户信息。</p>
<p>改造Order如下图：</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps35.png"  alt="img"> </p>
<h4 id="Mapper-xml-1"><a href="#Mapper-xml-1" class="headerlink" title="Mapper.xml"></a><strong>Mapper.xml</strong></h4><p>这里 resultMap 指定 orderUserResultMap,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>= <span class="string">"order"</span> <span class="attr">id</span>= <span class="string">"orderUserResultMap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>= <span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"userId"</span> <span class="attr">column</span>= <span class="string">"user_id"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"number"</span> <span class="attr">column</span>= <span class="string">"number"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"createtime"</span> <span class="attr">column</span>= <span class="string">"createtime"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"note"</span> <span class="attr">column</span>= <span class="string">"note"</span> /&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- association:配置一对一属性--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- property:order里面的User属性名--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- javaType:属性类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>= <span class="string">"user"</span> <span class="attr">javaType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--id:声明主键，表示user_id是关联查询对象的唯一标识--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>= <span class="string">"id"</span> <span class="attr">column</span>= <span class="string">"user_id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"username"</span> <span class="attr">column</span>= <span class="string">"username"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"address"</span> <span class="attr">column</span>= <span class="string">"address"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--一对一关联，查询订单，订单内部包含用户属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryOrderUserResultMap"</span> <span class="attr">resultMap</span>= <span class="string">"orderuserResultMap"</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    o.id,</span><br><span class="line">    o.user_id,</span><br><span class="line">    O.number,</span><br><span class="line">    o.createtime,</span><br><span class="line">    o.note ,</span><br><span class="line">    u.username,</span><br><span class="line">    u.address</span><br><span class="line">    FROM </span><br><span class="line">    `order` o</span><br><span class="line">    LEFT JOIN `user` u ON o.user_id = u.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Mapper-接口-5"><a href="#Mapper-接口-5" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h4><p>编写UserMapper如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568990183345.png"  alt="1568990183345"></p>
<h4 id="测试方法-5"><a href="#测试方法-5" class="headerlink" title="测试方法"></a>测试方法</h4><p>在UserMapperTest增加测试方法，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryorderUserResultMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">//使用userMapper执行根据条件查询用户</span></span><br><span class="line">    List&lt;Order&gt; list = userMapper.queryorderUserResultMap();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(Order o : list) &#123;</span><br><span class="line">    	System.out.println(o);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果-9"><a href="#效果-9" class="headerlink" title="效果"></a>效果</h4><p>测试效果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568990337914.png"  alt="1568990337914"></p>
<h2 id="一对多查询"><a href="#一对多查询" class="headerlink" title="一对多查询"></a>一对多查询</h2><p>案例：查询所有用户信息及用户关联的订单信息。 用户信息和订单信息为一对多关系。</p>
<p>sql语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    u.id,</span><br><span class="line">    u.username,</span><br><span class="line">    u.birthday,</span><br><span class="line">    u.sex,</span><br><span class="line">    u.address,</span><br><span class="line">    o.id oid,</span><br><span class="line">    o.number,</span><br><span class="line">    o.createtime,</span><br><span class="line">    o.note</span><br><span class="line">FROM</span><br><span class="line">	&#96;user&#96; u</span><br><span class="line">LEFT JOIN &#39;order&#39; o ON u.id &#x3D; o.user_id</span><br></pre></td></tr></table></figure>

<h3 id="修改-pojo-类"><a href="#修改-pojo-类" class="headerlink" title="修改 pojo 类"></a>修改 <strong>pojo</strong> 类</h3><p>在User类中加入List属性，如下图:</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps36.png"  alt="img"> </p>
<h3 id="Mapper-xml-2"><a href="#Mapper-xml-2" class="headerlink" title="Mapper.xml"></a><strong>Mapper.xml</strong></h3><p>在 UserMapper.xml 添加 sql,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>= <span class="string">"user"</span> <span class="attr">id</span>= <span class="string">"userOrderResul tMap "</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>= <span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"birthday"</span> <span class="attr">column</span>= <span class="string">"birthday"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"sex"</span> <span class="attr">column</span>=<span class="string">"sex"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>= <span class="string">"address"</span> <span class="attr">column</span>= <span class="string">"address"</span> /&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--配置一对多的关系--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>= <span class="string">"orders"</span> <span class="attr">javaType</span>=<span class="string">"list"</span> <span class="attr">ofType</span>=<span class="string">"order"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置主键，是关联Order的唯一标识--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"oid"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"number"</span> <span class="attr">column</span>=<span class="string">"number"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"createtime"</span> <span class="attr">column</span>=<span class="string">"createtime"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"note"</span> <span class="attr">column</span>=<span class="string">"note"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--对多关联，查询订单同时查询该用户下的订单--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUser0rder"</span> <span class="attr">resultMap</span>= <span class="string">"userorderResultMap"</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    u.id,</span><br><span class="line">    u.username，</span><br><span class="line">    u.birthday,</span><br><span class="line">    u.address,</span><br><span class="line">    o.id oid,</span><br><span class="line">    O.number,</span><br><span class="line">    0.createtime,</span><br><span class="line">    O.note</span><br><span class="line">    FROM</span><br><span class="line">    user u</span><br><span class="line">    LEFT JOIN `order` o ON u.id = o.user_id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Mapper-接口-6"><a href="#Mapper-接口-6" class="headerlink" title="Mapper 接口"></a><strong>Mapper</strong> 接口</h3><p>编写UserMapper接口，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568990732961.png"  alt="1568990732961"></p>
<h3 id="测试方法-6"><a href="#测试方法-6" class="headerlink" title="测试方法"></a>测试方法</h3><p>在UserMapperTest增加测试方法，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryuserorder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//mybatis 和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//创建Mapper接口的动态代理对象，整合之后，交给spring管理</span></span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">//使用userMapper执行根据条件查询用户</span></span><br><span class="line">    List&lt;User&gt; list = userMapper.queryUserorder();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (User u : list) &#123;</span><br><span class="line">    	System.out.println(u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//mybatis和spring整合，整合之后，交给spring管理</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-10"><a href="#效果-10" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568990917444.png"  alt="1568990917444"></p>
<h1 id="Mybatis-整合-spring"><a href="#Mybatis-整合-spring" class="headerlink" title="Mybatis 整合 spring"></a><strong>Mybatis</strong> 整合 <strong>spring</strong></h1><h2 id="整合思路"><a href="#整合思路" class="headerlink" title="整合思路"></a>整合思路</h2><p>1、SqISessionFactory对象应该放到spring容器中作为单例存在。</p>
<p>2、传统dao的开发方式中，应该从spring容器中获得sqlsession对象。</p>
<p>3、Mapper代理形式中，应该从spring容器中直接获得mapper的代理对象。</p>
<p>4、数据库的连接以及数据库连接池事务管理都交给spring容器来完成。</p>
<h2 id="整合需要的jar包"><a href="#整合需要的jar包" class="headerlink" title="整合需要的jar包"></a><strong>整合需要的</strong>jar包</h2><p>1、spring 的 jar 包</p>
<p>2、Mybatis 的 jar 包</p>
<p>3、Spring+mybatis 的整合包。</p>
<p>4、Mysql的数据库驱动jar包。</p>
<p>5、数据库连接池的jar包。</p>
<p>jar包位置如下所示:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991007279.png"  alt="1568991007279"></p>
<h2 id="整合的步骤"><a href="#整合的步骤" class="headerlink" title="整合的步骤"></a>整合的步骤</h2><h3 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h3><p>如下图创建一个java工程:</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps37.png"  alt="img"> </p>
<h3 id="导入jar包"><a href="#导入jar包" class="headerlink" title="导入jar包"></a>导入<strong>jar</strong>包</h3><p>前面提到的jar包需要导入，如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991096303.png"  alt="1568991096303"></p>
<h3 id="加入配置文件"><a href="#加入配置文件" class="headerlink" title="加入配置文件"></a>加入配置文件</h3><p>1.mybatisSpring的配置文件</p>
<p>2.的配置文件 sqlmapConfig.xml</p>
<p>​    a）数据库连接及连接池</p>
<p>​    b）事务管理（暂时可以不配置）</p>
<p>​    c）sqlsessionFactory 对象，配置到 spring 容器中</p>
<p>​    d）mapeer代理对象或者是dao实现类配置到spring容器中。</p>
<p>创建资源文件夹config拷贝加入配置文件，如下图</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991163459.png"  alt="1568991163459"></p>
<h4 id="SqlMapConfig-xml"><a href="#SqlMapConfig-xml" class="headerlink" title="SqlMapConfig.xml"></a><strong>SqlMapConfig.xml</strong></h4><p>配置文件是SqlMapConfig.xml,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version= "1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 2.指定扫描包，会把包内所有的类都设置别名，别名的名称就是类名，大小写不敏感--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>= <span class="string">"cn.itcast.mybatis.pojo"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/ <span class="attr">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a><strong>applicationContext.xml</strong></h4><p>SqISessionFactoryBean 属于 mybatis-spring 这个jar 包</p>
<p>对于spring来说，mybatis是另外一个架构，需要整合jar包。</p>
<p>在项目中加入mybatis-spring-1.2.2.jar的源码，如下图</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991370650.png"  alt="1568991370650"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps39.png"  alt="img"> </p>
<p>效果，如下图所示，图标变化，表示源码加载成功:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991423511.png"  alt="1568991423511"></p>
<p>整合Mybatis需要的是SqISessionFactoryBean,位置如下图: </p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568991469078.png"  alt="1568991469078"></p>
<p>applicationContext.xml，配置内容如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/aop/spring-aop-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/tx/spring-tx-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/util</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/util/spring-util-4.0.xsd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--加载配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:</span> <span class="attr">property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--数据库连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置SqlSessionFactory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置mybatis核心配置文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:SqLMapConfig.xml"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置数据源--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="db-properties"><a href="#db-properties" class="headerlink" title="db.properties"></a><strong>db.properties</strong></h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<h4 id="Iog4j-properties"><a href="#Iog4j-properties" class="headerlink" title="Iog4j.properties"></a><strong>Iog4j.properties</strong></h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,stdout</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="meta">1og4j.appender.stdout</span> =<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">1og4j.appender.stdout.layout</span> =<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure>

<h4 id="效果-11"><a href="#效果-11" class="headerlink" title="效果"></a>效果</h4><p>加入的配置文件最终效果如下：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568992613855.png"  alt="1568992613855"></p>
<h2 id="Dao的开发"><a href="#Dao的开发" class="headerlink" title="Dao的开发"></a><strong>Dao</strong>的开发</h2><p>两种dao的实现方式：</p>
<p>1、原始dao的开发方式</p>
<p>2、使用Mapper代理形式开发方式</p>
<p>​    a）直接配置Mapper代理</p>
<p>​    b）使用扫描包配置Mapper代理</p>
<p>需求：</p>
<ol>
<li><p>实现根据用户id查询</p>
</li>
<li><p>实现根据用户名模糊查询</p>
</li>
<li><p>添加用户</p>
</li>
</ol>
<h3 id="创建-pojo"><a href="#创建-pojo" class="headerlink" title="创建 pojo"></a>创建 <strong>pojo</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String username;<span class="comment">// 用户姓名</span></span><br><span class="line">    <span class="keyword">private</span> String sex;<span class="comment">// 性别</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;<span class="comment">// 生口 </span></span><br><span class="line">    <span class="keyword">private</span> String address;<span class="comment">// 地址</span></span><br><span class="line"></span><br><span class="line">    get/set...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="传统dao的开发方式"><a href="#传统dao的开发方式" class="headerlink" title="传统dao的开发方式"></a>传统<strong>dao</strong>的开发方式</h3><p>原始的DAO开发接口 +实现类来完成。</p>
<p>需要dao实现类需要继承SqlsessionDaoSupport类</p>
<h4 id="实现-Mapper-xml"><a href="#实现-Mapper-xml" class="headerlink" title="实现 Mapper.xml"></a>实现 <strong>Mapper.xml</strong></h4><p>编写User.xml配置文件，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8”?&gt;</span></span><br><span class="line"><span class="meta">&lt;!IDOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"test"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--根据用户id查询--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserById"</span> <span class="attr">parameterType</span>= <span class="string">"int"</span> <span class="attr">resultType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">    	select * from user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--根据用户名模糊查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByUsername"</span> <span class="attr">parameterType</span>= <span class="string">"string"</span> <span class="attr">resultType</span>= <span class="string">"user "</span>&gt;</span></span><br><span class="line">    	select * from user where username like '%$&#123;value&#125;%'</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--添加用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>= <span class="string">"saveUser"</span> <span class="attr">parameterType</span>= <span class="string">"user"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>= <span class="string">"id"</span> <span class="attr">keyColumn</span>= <span class="string">"id"</span> <span class="attr">order</span>= <span class="string">"AFTER"</span> <span class="attr">resultType</span>= <span class="string">"int"</span>&gt;</span></span><br><span class="line">            select last_insert_id()</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into user</span><br><span class="line">        (username,birthday,sex,address)</span><br><span class="line">        values</span><br><span class="line">        (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="加载-Mapper-xml"><a href="#加载-Mapper-xml" class="headerlink" title="加载 Mapper.xml"></a>加载 <strong>Mapper.xml</strong></h4><p>在SqlMapConfig如下图进行配置：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568993005358.png"  alt="1568993005358"></p>
<h4 id="实现-UserDao-接口"><a href="#实现-UserDao-接口" class="headerlink" title="实现 UserDao 接口"></a>实现 <strong>UserDao</strong> 接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据id查询用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据用户名模糊查询用户列表</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">queryUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *保存</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="实现-UserDaoImpI-实现类"><a href="#实现-UserDaoImpI-实现类" class="headerlink" title="实现 UserDaoImpI 实现类"></a>实现 <strong>UserDaoImpI</strong> 实现类</h4><p>编写DAO实现类，实现类必须集成SqlSessionDaoSupport</p>
<p>SqlSessionDaoSupport 提供 getSqlSession()方法来获取 SqlSession</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpI</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 SqlSession</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">super</span>.getSqlSession();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用SqlSession执行操作</span></span><br><span class="line">        User user = sqlSession.selectOne(<span class="string">"queryUserByld"</span>,id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//不要关闭sqlSession</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">queryUserByUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 SqlSession</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">super</span>.getSqlSession();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用SqlSession执行操作</span></span><br><span class="line">        List&lt;User&gt; list = sqlSession.selectList(<span class="string">"queryUserByUsername"</span>,username);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//不要关闭sqlSession</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> saveL)ser(User user) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 SqlSession</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">super</span>.getSqlSession();</span><br><span class="line">    </span><br><span class="line">        <span class="comment">//使用SqlSession执行操作</span></span><br><span class="line">        sqlSession.insert(<span class="string">"saveUser"</span>, user);</span><br><span class="line">    </span><br><span class="line">        <span class="comment">//不用提交，事务由spring进行管理</span></span><br><span class="line">        <span class="comment">//不要关闭sqlSession</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="配置-dao"><a href="#配置-dao" class="headerlink" title="配置 dao"></a>配置 <strong>dao</strong></h4><p>把dao实现类配置到spring容器中，如下图</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568993344293.png"  alt="1568993344293"></p>
<h4 id="测试方法-7"><a href="#测试方法-7" class="headerlink" title="测试方法"></a>测试方法</h4><p>创建测试方法，可以直接创建测试Junit用例。 如下图所示进行创建。</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568993447482.png"  alt="1568993447482"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps40.png"  alt="img"> </p>
<p> <img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568993494951.png"  alt="1568993494951"></p>
<p>编写测试方法如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Applicationcontext context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationContext.xml"</span>);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 userDao</span></span><br><span class="line">        UserDao userDao = <span class="keyword">this</span>.context.getBean(UserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        </span><br><span class="line">        User user = userDao.queryUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 userDao</span></span><br><span class="line">        UserDao userDao = <span class="keyword">this</span>.context.getBean(UserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; list = userDao.queryUserByllsername(<span class="string">"张"</span>)；</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">for</span> (User user : list) (</span><br><span class="line">                System.out.println(user);</span><br><span class="line">    		&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 userDao</span></span><br><span class="line">        UserDao userDao = <span class="keyword">this</span>.context.getBean(UserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        User user = <span class="keyword">new</span> User()； </span><br><span class="line">        user. setUsername (<span class="string">"曹操"</span>)；</span><br><span class="line">        user.setSex(<span class="string">"1"</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        user. setAddress(<span class="string">"三国"</span>)；</span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Mapper代理形式开发dao"><a href="#Mapper代理形式开发dao" class="headerlink" title="Mapper代理形式开发dao"></a><strong>Mapper</strong>代理形式开发<strong>dao</strong></h3><h4 id="实现-Mapper-xml-1"><a href="#实现-Mapper-xml-1" class="headerlink" title="实现 Mapper.xml"></a>实现 <strong>Mapper.xml</strong></h4><p>编写UserMapper.xml配置文件，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN”</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"</span>http://mybatis.org/dtd/mybatis-3-mapper.dtd<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;mapper namespace= "</span>cn.itcast.mybatis.mapper.UserMapper<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--根据用户id查询--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;select id= "</span>queryUserById<span class="meta-string">" parameterType= "</span>int<span class="meta-string">" resultType= "</span>user<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        select * from user where id = #&#123;id&#125;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/select&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--根据用户名模糊查询用户--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;select id="</span>queryUserByUsername<span class="meta-string">" parameterType= "</span>string<span class="meta-string">" resultType= "</span>user<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    	select * from user where username like '%$&#123;value&#125;%'</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/select&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--添加用户--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;insert id="</span>saveUser<span class="meta-string">" parameterType= "</span>user<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;selectKey keyProperty= "</span>id<span class="meta-string">" keyColumn= "</span>id<span class="meta-string">" order= "</span>AFTER<span class="meta-string">" resultType="</span>int<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        	select last_insert_id()</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;/selectKey&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        insert into user</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        (username,birthday,sex,address) values</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/insert&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;/mapper&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="实现-UserMapper-接口"><a href="#实现-UserMapper-接口" class="headerlink" title="实现 UserMapper 接口"></a>实现 <strong>UserMapper</strong> 接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据用户id查询</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据用户名模糊查询用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">queryUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *添加用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式一：配置mapper代理"><a href="#方式一：配置mapper代理" class="headerlink" title="方式一：配置mapper代理"></a>方式一：配置<strong>mapper</strong>代理</h4><p>在 applicationContext.xml 添加配置</p>
<p>MapperFactoryBean 也是属于 mybatis-spring 整合包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mappen代理的方式开发方式一，配置Mapper代理对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>= <span class="string">"userMapper"</span> <span class="attr">class</span>= <span class="string">"org.mybatis.spring.mapper.MapperFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置Mapper接口--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"mapperInterface"</span> <span class="attr">value</span>= <span class="string">"cn.itcast.mybatis.mapper.UserMapper"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置sqlSessionFactory --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="测试方法-8"><a href="#测试方法-8" class="headerlink" title="测试方法"></a>测试方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Applicationcontext context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationcontext.xml"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Mapper</span></span><br><span class="line">        UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        User user = userMapper.queryUserByld(l);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Mapper</span></span><br><span class="line">        UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; list = userMapper.queryUserByUsername(<span class="string">"张"</span>)；</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (User user : list) (</span><br><span class="line">        	System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取 Mapper</span></span><br><span class="line">    UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    User user = <span class="keyword">new</span> User(); </span><br><span class="line">    user.setUsername (<span class="string">"曹操"</span>)； </span><br><span class="line">    user.setSex(<span class="string">"1"</span>);</span><br><span class="line">    user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">    user.setAddress(<span class="string">"三国"</span>)；</span><br><span class="line">    userMapper.saveUser(user);</span><br><span class="line"></span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式二：扫描包形式配置mapper"><a href="#方式二：扫描包形式配置mapper" class="headerlink" title="方式二：扫描包形式配置mapper"></a>方式二：扫描包形式配置<strong>mapper</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mapper代理的方式开发方式二，扫描包方式配置代理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置 Mapper 接口 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"cn.itcast.mybatis.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>每个mapper代理对象的id就是类名，首字母小写</p>
<h1 id="Mybatis逆向工程"><a href="#Mybatis逆向工程" class="headerlink" title="Mybatis逆向工程"></a>Mybatis逆向工程</h1><p>使用官方网站的Mapper自动生成工具mybatis-generator-core-1.3.2来生成po类 和Mapper映射文件</p>
<h2 id="导入逆向工程"><a href="#导入逆向工程" class="headerlink" title="导入逆向工程"></a>导入逆向工程</h2><p>使用课前资料已有逆向工程，如下图：</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps46.png"  alt="img"></p>
<h3 id="复制逆向工程到工作空间中"><a href="#复制逆向工程到工作空间中" class="headerlink" title="复制逆向工程到工作空间中"></a>复制逆向工程到工作空间中</h3><p>复制的效果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568994855184.png"  alt="1568994855184"></p>
<h3 id="导入逆向工程到eclipse中"><a href="#导入逆向工程到eclipse中" class="headerlink" title="导入逆向工程到eclipse中"></a>导入逆向工程到<strong>eclipse</strong>中</h3><p>如下图方式进行导入:</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps47.png"  alt="img"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps48.png"  alt="img"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps49.png"  alt="img"> </p>
<h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>在generatorConfig.xml中配置Mapper生成的详细信息,如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568994935415.png"  alt="1568994935415"></p>
<p>注意修改以下几点：</p>
<ol>
<li><p>修改要生成的数据库表</p>
</li>
<li><p>pojo文件所在包路径</p>
</li>
<li><p>Mapper所在的包路径</p>
</li>
</ol>
<p>配置文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">| <span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConf</span> <span class="meta-keyword">iguration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>= <span class="string">"testTables"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt; <span class="attr">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--是否去除自动生成的注释true:是: false:否 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库连接的信息:驱动类、连接地址、用户名、密码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>= <span class="string">"com.mysql.jdbc.Driver"</span> <span class="attr">connectionURL</span>= <span class="string">"jdbc:mysql://Localhost:3306/mybatis"</span> <span class="attr">userId</span>= <span class="string">"root"</span> <span class="attr">password</span>= <span class="string">"root"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;jdbcConnection driverClass="oracle.jdbc.OracleDriver" connectionURL="jdbcoracle:thin:@127.0.0.1:1521:yycg" userId="yycg" password="yycg"&gt; &lt;/jdbcConnection&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--默认false,把JDBC DECIMAL和 NUMERIC 类型解析为Integer,为true时把JDBC DECIMAL</span></span><br><span class="line"><span class="comment">        和NUMERIC类型解析为java.math.BigDecimal --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"forceBigDecimals"</span> <span class="attr">value</span>= <span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- targetProject:生成PO类的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt; <span class="attr">javaModelGenerator</span> <span class="attr">targetPackage</span>= <span class="string">"cn.itcast.ssm.po"</span> <span class="attr">targetProject</span>=<span class="string">".\src"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages: 是否让schema作为包的后缀--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"enableSubPackages"</span> <span class="attr">value</span>= <span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--从数据库返回的值被清理前后的空格--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"trimStrings"</span> <span class="attr">value</span>= <span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--targetProject:mapper映射文件生成的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>= <span class="string">"cn.itcast.ssm.mapper"</span> <span class="attr">targetroject</span>=<span class="string">".\src"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--enableSubPackages :是否让schema作为包的后缀--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--targetPackage:mapper接口生成的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>= <span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>= <span class="string">"cn.itcast.ssm.mapper"</span> <span class="attr">targetProject</span>=<span class="string">".\src"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- enableSubPackages :是否让schema作为包的后缀--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定数据库表--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">schema</span>=<span class="string">""</span> <span class="attr">tableName</span>= <span class="string">"user"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">schema</span>=<span class="string">""</span> <span class="attr">tableName</span>= <span class="string">"order"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="生成逆向工程代码"><a href="#生成逆向工程代码" class="headerlink" title="生成逆向工程代码"></a>生成逆向工程代码</h2><p>找到下图所示的java文件，执行工程main主函数,</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568995571133.png"  alt="1568995571133"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml4508%5Cwps50.png"  alt="img"></p>
<p>刷新工程，发现代码生成，如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568995592071.png"  alt="1568995592071"></p>
<h2 id="测试逆向工程代码"><a href="#测试逆向工程代码" class="headerlink" title="测试逆向工程代码"></a>测试逆向工程代码</h2><ol>
<li>复制生成的代码到mybatis-spring工程，如下图</li>
</ol>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568995620753.png"  alt="1568995620753"></p>
<ol start="2">
<li>修改spring配置文件</li>
</ol>
<p>在 applicationContext.xml 修改</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mapper代理的方式开发，扫描包方式配置代理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置Mapper接口，如果需要加载多个包，直接写进来，中间用，分隔--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;property name="basePackage" value="cn.itcast.mybatis.mapper" /&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"cn.itcast.ssm.mapper"</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>编写测试方法：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Applicationcontext context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setllp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationcontext.xml"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取Mapper</span></span><br><span class="line">        UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">"曹操"</span>)；</span><br><span class="line">        user.setSex(<span class="string">"1"</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        user.setAddress(<span class="string">"三国"</span>)；</span><br><span class="line"></span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByExample</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取 Mapper</span></span><br><span class="line">        UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//创建User对象扩展类，用户设置查询条件</span></span><br><span class="line">        UserExample example = <span class="keyword">new</span> UserExample();</span><br><span class="line">        example.cneateCriteria().andUsernameLike(<span class="string">"％张％"</span>)；</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查询数据</span></span><br><span class="line">        List&lt;User&gt; list = userMapper.selectByExample(example);</span><br><span class="line"></span><br><span class="line">        System.out.println(list.size());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByPrimaryKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取 Mapper</span></span><br><span class="line">        UserMapper userMapper = <span class="keyword">this</span>.context.getBean(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        </span><br><span class="line">        User user = userMapper.selectByPrimaryKey(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ol>
<li><p>逆向工程生成的代码只能做单表查询</p>
</li>
<li><p>不能在生成的代码上进行扩展，因为如果数据库变更，需要重新使用逆向工程生成 代码，原来编写的代码就被覆盖了。</p>
</li>
<li><p>一张表会生成4个文件</p>
</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Reddes</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://reddescode.github.io/2019/09/17/MyBatis02/">http://reddescode.github.io/2019/09/17/MyBatis02/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://ReddesCode.github.io" target="_blank">Reddes的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MyBatis-2/">MyBatis-2</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/09/17/MyBatis01/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MyBatis01</div></div></a></div><div class="next-post pull_right"><a href="/2019/09/17/Eclipse%E9%9B%86%E6%88%90tomcat%E5%B9%B6%E5%8F%91%E5%B8%83Javaweb%E5%BA%94%E7%94%A8/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Eclipse集成tomcat并发布Javaweb应用</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'f31J5kVi0JdGq11UOxhQJ12Y-gzGzoHsz',
  appKey: 'urv1VlxqDU3Naidx9UGV9zmW',
  notify: true,
  verify: true,
  placeholder: '写点什么。。',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Reddes</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>