<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MyBatis01 | Reddes的个人博客</title><meta name="description" content="Mybatis 介绍MyBatis本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了 google code,并且改名为 MyBatis。2013 年 11 月 迁移到Github。 MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装, 使开发者只需要关注SQL本身，而不需要花费精力去处理例如注"><meta name="keywords" content="MyBatis01"><meta name="author" content="Reddes"><meta name="copyright" content="Reddes"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MyBatis01"><meta name="twitter:description" content="Mybatis 介绍MyBatis本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了 google code,并且改名为 MyBatis。2013 年 11 月 迁移到Github。 MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装, 使开发者只需要关注SQL本身，而不需要花费精力去处理例如注"><meta name="twitter:image" content="http://reddescode.github.io/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="MyBatis01"><meta property="og:url" content="http://reddescode.github.io/2019/09/17/MyBatis01/"><meta property="og:site_name" content="Reddes的个人博客"><meta property="og:description" content="Mybatis 介绍MyBatis本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了 google code,并且改名为 MyBatis。2013 年 11 月 迁移到Github。 MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装, 使开发者只需要关注SQL本身，而不需要花费精力去处理例如注"><meta property="og:image" content="http://reddescode.github.io/img/post.jpg"><meta property="article:published_time" content="2019-09-17T12:45:00.000Z"><meta property="article:modified_time" content="2020-04-26T15:17:14.217Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://reddescode.github.io/2019/09/17/MyBatis01/"><link rel="prev" title="http协议简介" href="http://reddescode.github.io/2019/09/17/http%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B/"><link rel="next" title="MyBatis02" href="http://reddescode.github.io/2019/09/17/MyBatis02/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">332</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">80</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">47</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis-介绍"><span class="toc-number">1.</span> <span class="toc-text">Mybatis 介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用jdbc编程及问题总结"><span class="toc-number">2.</span> <span class="toc-text">使用jdbc编程及问题总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建mysql数据库"><span class="toc-number">2.1.</span> <span class="toc-text">创建mysql数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建工程"><span class="toc-number">2.2.</span> <span class="toc-text">创建工程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编程步骤"><span class="toc-number">2.3.</span> <span class="toc-text">编程步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdbc程序"><span class="toc-number">2.4.</span> <span class="toc-text">jdbc程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdbc问题总结"><span class="toc-number">2.5.</span> <span class="toc-text">jdbc问题总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis-架构"><span class="toc-number">3.</span> <span class="toc-text">Mybatis 架构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybatis入门程序"><span class="toc-number">4.</span> <span class="toc-text">Mybatis入门程序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mybatis下载"><span class="toc-number">4.1.</span> <span class="toc-text">mybatis下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#业务需求"><span class="toc-number">4.2.</span> <span class="toc-text">业务需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#环境搭建"><span class="toc-number">4.3.</span> <span class="toc-text">环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建java工程"><span class="toc-number">4.3.1.</span> <span class="toc-text">创建java工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入jar包"><span class="toc-number">4.3.2.</span> <span class="toc-text">加入jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入配置文件"><span class="toc-number">4.3.3.</span> <span class="toc-text">加入配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Iog4j-properties"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">Iog4j.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SqlMapConfig-xml"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">SqlMapConfig.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果"><span class="toc-number">4.3.3.3.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建-pojo"><span class="toc-number">4.3.4.</span> <span class="toc-text">创建 pojo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第六步：sql映射文件"><span class="toc-number">4.3.5.</span> <span class="toc-text">第六步：sql映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第七步：加载映射文件"><span class="toc-number">4.3.6.</span> <span class="toc-text">第七步：加载映射文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现根据id查询用户"><span class="toc-number">4.4.</span> <span class="toc-text">实现根据id查询用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#映射文件"><span class="toc-number">4.4.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试程序"><span class="toc-number">4.4.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-1"><span class="toc-number">4.4.3.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现根据用户名模糊查询用户"><span class="toc-number">4.5.</span> <span class="toc-text">实现根据用户名模糊查询用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方法一"><span class="toc-number">4.5.1.</span> <span class="toc-text">方法一</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#映射文件-1"><span class="toc-number">4.5.1.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试程序-1"><span class="toc-number">4.5.1.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-2"><span class="toc-number">4.5.1.3.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法二"><span class="toc-number">4.5.2.</span> <span class="toc-text">方法二</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#映射文件-2"><span class="toc-number">4.5.2.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试程序-2"><span class="toc-number">4.5.2.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果-3"><span class="toc-number">4.5.2.3.</span> <span class="toc-text">效果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">4.6.</span> <span class="toc-text">小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#和"><span class="toc-number">4.6.1.</span> <span class="toc-text">#{}和${}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parameterType-和-resultType"><span class="toc-number">4.6.2.</span> <span class="toc-text">parameterType 和 resultType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#selectOne-和-selectList"><span class="toc-number">4.6.3.</span> <span class="toc-text">selectOne 和 selectList</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现添加用户"><span class="toc-number">4.7.</span> <span class="toc-text">实现添加用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#映射文件-3"><span class="toc-number">4.7.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试程序-3"><span class="toc-number">4.7.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-4"><span class="toc-number">4.7.3.</span> <span class="toc-text">效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql自增主键返回"><span class="toc-number">4.7.4.</span> <span class="toc-text">mysql自增主键返回</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mysql使用uuid实现主键"><span class="toc-number">4.7.5.</span> <span class="toc-text">Mysql使用uuid实现主键</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改用户"><span class="toc-number">4.8.</span> <span class="toc-text">修改用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#映射文件-4"><span class="toc-number">4.8.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试程序-4"><span class="toc-number">4.8.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-5"><span class="toc-number">4.8.3.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除用户"><span class="toc-number">4.9.</span> <span class="toc-text">删除用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#映射文件-5"><span class="toc-number">4.9.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试程序-5"><span class="toc-number">4.9.2.</span> <span class="toc-text">测试程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#效果-6"><span class="toc-number">4.9.3.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis解决jdbc编程的问题"><span class="toc-number">4.10.</span> <span class="toc-text">Mybatis解决jdbc编程的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mybatis-与-hibernate-不同"><span class="toc-number">4.11.</span> <span class="toc-text">mybatis 与 hibernate 不同</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dao开发方法"><span class="toc-number">5.</span> <span class="toc-text">Dao开发方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#需求"><span class="toc-number">5.1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SqISession的使用范围"><span class="toc-number">5.2.</span> <span class="toc-text">SqISession的使用范围</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SqISessionFactoryBuilder"><span class="toc-number">5.2.1.</span> <span class="toc-text">SqISessionFactoryBuilder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SqISessionFactory"><span class="toc-number">5.2.2.</span> <span class="toc-text">SqISessionFactory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SqISession"><span class="toc-number">5.2.3.</span> <span class="toc-text">SqISession</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原始Dao开发方式"><span class="toc-number">5.3.</span> <span class="toc-text">原始Dao开发方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#映射文件-6"><span class="toc-number">5.3.1.</span> <span class="toc-text">映射文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dao-接口"><span class="toc-number">5.3.2.</span> <span class="toc-text">Dao 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dao实现类"><span class="toc-number">5.3.3.</span> <span class="toc-text">Dao实现类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dao-测试"><span class="toc-number">5.3.4.</span> <span class="toc-text">Dao 测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#问题"><span class="toc-number">5.3.5.</span> <span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapper动态代理方式"><span class="toc-number">5.4.</span> <span class="toc-text">Mapper动态代理方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开发规范"><span class="toc-number">5.4.1.</span> <span class="toc-text">开发规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-xml（映射文件）"><span class="toc-number">5.4.2.</span> <span class="toc-text">Mapper.xml（映射文件）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加载-UserMapper-xml-文件"><span class="toc-number">5.4.3.</span> <span class="toc-text">加载 UserMapper.xml 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#小结-1"><span class="toc-number">5.4.4.</span> <span class="toc-text">小结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#♦-selectOne-和-selectList"><span class="toc-number">5.4.4.1.</span> <span class="toc-text">♦ selectOne 和 selectList</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#♦-namespace"><span class="toc-number">5.4.4.2.</span> <span class="toc-text">♦ namespace</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SqlMapConfig-xml-配置文件"><span class="toc-number">6.</span> <span class="toc-text">SqlMapConfig.xml 配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#配置内容"><span class="toc-number">6.1.</span> <span class="toc-text">配置内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#properties（属性）"><span class="toc-number">6.2.</span> <span class="toc-text">properties（属性）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#typeAliases（类型别名）"><span class="toc-number">6.3.</span> <span class="toc-text">typeAliases（类型别名）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mybatis-支持别名"><span class="toc-number">6.3.1.</span> <span class="toc-text">mybatis 支持别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义别名"><span class="toc-number">6.3.2.</span> <span class="toc-text">自定义别名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mappers（映射器）"><span class="toc-number">6.4.</span> <span class="toc-text">mappers（映射器）</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Reddes的个人博客</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MyBatis01</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2019-09-17 20:45:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-09-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-04-26 23:17:14"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-26</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/">IT</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/">后端</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/">Java</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/">JavaEE</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/%E6%A1%86%E6%9E%B6/">框架</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/IT/%E5%90%8E%E7%AB%AF/Java/JavaEE/%E6%A1%86%E6%9E%B6/MyBatis01/">MyBatis01</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="Mybatis-介绍"><a href="#Mybatis-介绍" class="headerlink" title="Mybatis 介绍"></a>Mybatis 介绍</h1><p>MyBatis本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了 google code,并且改名为 MyBatis。2013 年 11 月 迁移到Github。</p>
<p>MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装, 使开发者只需要关注SQL本身，而不需要花费精力去处理例如注册驱动、创建 connection、创建statement、手动设置参数、结果集检索等jdbc繁杂的过程代码。</p>
<p>Mybatis通过xml或注解的方式将要执行的各种statement (statement、 preparedStatemnt、CallableStatement)配置起来，并通过 java 对象和 statement 中的sql进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结 果映射成java对象并返回。</p>
<h1 id="使用jdbc编程及问题总结"><a href="#使用jdbc编程及问题总结" class="headerlink" title="使用jdbc编程及问题总结"></a>使用jdbc编程及问题总结</h1><h2 id="创建mysql数据库"><a href="#创建mysql数据库" class="headerlink" title="创建mysql数据库"></a>创建mysql数据库</h2><p>创建数据库，将下图所示的sql脚本导入到数据库中。</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps1.png"  alt="img"> </p>
<p>导入后效果如下图:</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps2.png"  alt="img"> </p>
<h2 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h2><p>开发环境：</p>
<p>IDE： eclipse Mars2</p>
<p>JDK： 1.7 </p>
<p>1、创建一个java工程。 按下图进行创建</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps3.png"  alt="img"> </p>
<p>2、需要mysql的数据库驱动，如下图位置找到jar包。</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568896818438.png"  alt="1568896818438"></p>
<h2 id="编程步骤"><a href="#编程步骤" class="headerlink" title="编程步骤"></a>编程步骤</h2><p>1、    加载数据库驱动</p>
<p>2、    创建并获取数据库链接</p>
<p>3、    创建 jdbc statement 对象</p>
<p>4、    设置sql语句</p>
<p>5、    设置sql语句中的参数(使用preparedStatement)</p>
<p>6、    通过statement执行sql并获取结果</p>
<p>7、    对sql执行结果进行解析处理</p>
<p>8、    释放资源(resultSet、preparedstatement&gt; connection)</p>
<h2 id="jdbc程序"><a href="#jdbc程序" class="headerlink" title="jdbc程序"></a>jdbc程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Connection connection =<span class="keyword">null</span>;</span><br><span class="line">    Preparedstatement preparedstatement = <span class="keyword">null</span>; </span><br><span class="line">    ResultSet resultSet = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> (</span><br><span class="line">        <span class="comment">//加载数据库驱动</span></span><br><span class="line">        Class .forName (<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//通过驱动管理类获取数据库链接</span></span><br><span class="line">        connection =</span><br><span class="line">DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8"</span>,<span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">        <span class="comment">//定义sql语句？表示占位符</span></span><br><span class="line">        String sql = <span class="string">"select * from user where username = ?"</span>;</span><br><span class="line">        <span class="comment">//获取预处理statement</span></span><br><span class="line">        preparedstatement = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//设置参数，第…个参数为sql语句中参数的序号(从1开始)，第二个参数 为设置的参数值</span></span><br><span class="line">        preparedStatement.setString(<span class="number">1</span>,<span class="string">"王五"</span>)；</span><br><span class="line">        <span class="comment">//向数据库发出sql执行查询，查询出结果集</span></span><br><span class="line">        resultSet = preparedStatement.executeQuery();</span><br><span class="line">        <span class="comment">//遍历查询结果集</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">			System.out.println(resultSet.getString(<span class="string">"id"</span>) + <span class="string">" "</span> + resultSet.getString(<span class="string">"username"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        <span class="keyword">if</span> (resultSet != <span class="keyword">null</span>) (</span><br><span class="line">        	<span class="keyword">try</span> &#123;</span><br><span class="line">        		resultSet.close();</span><br><span class="line">    		&#125; <span class="keyword">catch</span> (SQLException e) (</span><br><span class="line">    			<span class="comment">// TODO Auto-generated catch block </span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span> (preparedStatement != <span class="keyword">null</span>) &#123;</span><br><span class="line">    		<span class="keyword">try</span> (</span><br><span class="line">    			preparedStatement.close();</span><br><span class="line">    		&#125; <span class="keyword">catch</span> (SQLException e) (</span><br><span class="line">    			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span> (connection != <span class="keyword">null</span>) (</span><br><span class="line">    		<span class="keyword">try</span> &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">    		&#125; <span class="keyword">catch</span> (SQLException e) (</span><br><span class="line">    			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上边使用jdbc的原始方法（未经封装）实现了查询数据库表记录的操作。</p>
<h2 id="jdbc问题总结"><a href="#jdbc问题总结" class="headerlink" title="jdbc问题总结"></a>jdbc问题总结</h2><p>1、数据库连接创建、释放频繁造成系统资源浪费，从而影响系统性能。如果使 用数据库连接池可解决此问题。</p>
<p>2、Sql语句在代码中硬编码，造成代码不易维护，实际应用中sql变化的可能较大，sql变动需要改变java代码。</p>
<p>3、使用preparedStatement向占有位符号传参数存在硬编码，因为sql语句的 where条件不一定，可能多也可能少，修改sql还要修改代码，系统不易维护。</p>
<p>4、对结果集解析存在硬编码（查询列名），sql变化导致解析代码变化，系统不 易维护，如果能将数据库记录封装成pojo对象解析比较方便。</p>
<h1 id="Mybatis-架构"><a href="#Mybatis-架构" class="headerlink" title="Mybatis 架构"></a>Mybatis 架构</h1><p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps4.png"  alt="img"> </p>
<p>1、mybatis 配置</p>
<p>SqlMapConfig.xml,此文件作为mybatis的全局配置文件，配置了 mybatis的运行 环境等信息。</p>
<p>mapper.xml文件即sql映射文件，文件中配置了操作数据库的sql语句。此文件 需要在SqlMapConfig.xml中加载。</p>
<p>2、通过mybatis环境等配置信息构造SqISessionFactory即会话工厂</p>
<p>3、由会话工厂创建sqISession即会话，操作数据库需要通过sqISession进行。</p>
<p>4、mybatis底层自定义了 Executor执行器接口操作数据库,Executor接口有两个 实现，一个是基本执行器、一个是缓存执行器。</p>
<p>5、Mapped Statement也是mybatis 一个底层封装对象，它包装了 mybatis配置 信息及sql映射信息等。mapper.xml文件中一个sql对应一个Mapped Statement 对象，sql 的 id 即是 Mapped statement 的 id。</p>
<p>6、Mapped Statement对sql执行输入参数进行定义，包括HashMap、基本类型、 pojo, Executor通过Mapped Statement在执行sql前将输入的java对象映射 至sql中，输入参数映射就是jdbc编程中对preparedStatement设置参数。</p>
<p>7、Mapped Statement对sql执行输出结果进行定义，包括HashMap、基本类型、 pojo, Executor通过Mapped Statement在执行sql后将输出结果映射至java 对象中，输岀结果映射过程相当于jdbc编程中对结果的解析处理过程。</p>
<h1 id="Mybatis入门程序"><a href="#Mybatis入门程序" class="headerlink" title="Mybatis入门程序"></a>Mybatis入门程序</h1><h2 id="mybatis下载"><a href="#mybatis下载" class="headerlink" title="mybatis下载"></a>mybatis下载</h2><p>mybaits的代码由github.com管理</p>
<p>下载地址：<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3/releases</a></p>
<p>课前资料提供的mybatis如下：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568898236772.png"  alt="1568898236772"></p>
<p>mybatis-3.2.7.jar    mybatis的核心包</p>
<p>lib文件夹              mybatis的依赖所在</p>
<p>mybatis-3.2.7.pdf       mybatis的使用手册</p>
<h2 id="业务需求"><a href="#业务需求" class="headerlink" title="业务需求"></a>业务需求</h2><p>使用MyBatis实现以下功能：</p>
<p>​    根据用户id查询一个用户</p>
<p>​    根据用户名称模糊查询用户列表 添加用户</p>
<p>​    更新用户</p>
<p>​    删除用户</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><h3 id="创建java工程"><a href="#创建java工程" class="headerlink" title="创建java工程"></a>创建java工程</h3><p>如下图使用之前创建的mybatis-first工程</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568898412810.png"  alt="1568898412810"></p>
<h3 id="加入jar包"><a href="#加入jar包" class="headerlink" title="加入jar包"></a>加入jar包</h3><p>加入mybatis核心包、依赖包、数据驱动包。</p>
<p>mybatis核心包</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568898448545.png"  alt="1568898448545"></p>
<p>mybatis依赖包</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568898467997.png"  alt="1568898467997"></p>
<p>数据库驱动包（已添加）</p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps5.png"  alt="img"> </p>
<p>效果：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568898503700.png"  alt="1568898503700"></p>
<h3 id="加入配置文件"><a href="#加入配置文件" class="headerlink" title="加入配置文件"></a>加入配置文件</h3><p>如下图创建资源文件夹config，加入log4j.properties 和SqlMapConfig.xml配置文件</p>
<p>  <img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps7.png"  alt="img"></p>
<p><img src="/" class="lazyload" data-src="file:///C:%5CUsers%5Czxq%5CAppData%5CLocal%5CTemp%5Cksohtml6592%5Cwps9.png"  alt="img"></p>
<h4 id="Iog4j-properties"><a href="#Iog4j-properties" class="headerlink" title="Iog4j.properties"></a>Iog4j.properties</h4><p>在 config下创建 Iog4j.properties 如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG, stdout</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache . log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure>

<p>mybatis默认使用Iog4j作为输出日志信息。</p>
<h4 id="SqlMapConfig-xml"><a href="#SqlMapConfig-xml" class="headerlink" title="SqlMapConfig.xml"></a>SqlMapConfig.xml</h4><p>在 config 下创建 SqlMapConfig.xml,如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.8//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--和spring整合后environments配置将废除--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>= <span class="string">"devel opment”</span></span></span><br><span class="line"><span class="tag"><span class="string">        &lt;environment id= "</span><span class="attr">development</span>"&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--使用jdbc事务管理--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>= <span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--数据库连接池--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>= <span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"driver"</span> <span class="attr">value</span>= <span class="string">"com. mysql. jdbc. Driver"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"url"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">value</span>= <span class="string">"jdbc :mysql://Localhost:3306/mybatis?characterEncoding=utf-8”/&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">                &lt;property name= "</span><span class="attr">username</span>”<span class="attr">value</span>= <span class="string">"root"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"password"</span> <span class="attr">value</span>= <span class="string">"root"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SqlMapConfig.xml是mybatis核心配置文件，配置文件内容为数据源、事务管理。</p>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568899219811.png"  alt="1568899219811"></p>
<h3 id="创建-pojo"><a href="#创建-pojo" class="headerlink" title="创建 pojo"></a>创建 pojo</h3><p>pojo类作为mybatis进行sql映射使用，po类通常与数据库表对应,</p>
<p>数据库user表如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568899265431.png"  alt="1568899265431"></p>
<p>User.java如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Public <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">private</span> String username;<span class="comment">// 用户姓名</span></span><br><span class="line"><span class="keyword">private</span> String sex;<span class="comment">// 性别</span></span><br><span class="line"><span class="keyword">private</span> Date birthday;<span class="comment">// 生日</span></span><br><span class="line"><span class="keyword">private</span> String address;<span class="comment">// 地址</span></span><br><span class="line">    </span><br><span class="line">get/ set.....</span><br></pre></td></tr></table></figure>



<h3 id="第六步：sql映射文件"><a href="#第六步：sql映射文件" class="headerlink" title="第六步：sql映射文件"></a>第六步：sql映射文件</h3><p>在config下的sqlmap目录下创建sql映射文件User.xml：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version= "1.0" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/ dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace: 命名空间，用于隔离sq1,还有一个很重要的作用，后面会讲--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"test"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="第七步：加载映射文件"><a href="#第七步：加载映射文件" class="headerlink" title="第七步：加载映射文件"></a>第七步：加载映射文件</h3><p>mybatis框架需要加载Mapper.xml映射文件</p>
<p>将 users.xml 添加在 SqlMapConfig.xml,如下:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568899541264.png"  alt="1568899541264"></p>
<h2 id="实现根据id查询用户"><a href="#实现根据id查询用户" class="headerlink" title="实现根据id查询用户"></a>实现根据id查询用户</h2><p>使用的sql:</p>
<p>SELECT * FROM <code>user</code> WHERE id = 1</p>
<h3 id="映射文件"><a href="#映射文件" class="headerlink" title="映射文件"></a>映射文件</h3><p>在user.xml中添加select标签，编写sql：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version= "1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC“-//mybatis.org//DTD <span class="meta-keyword">Mapper</span> 3.0//EN”</span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace: 命名空间，用于隔离sq1, 还有一个很重要的作用，后面会讲--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"test"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- id:statement 的id或者叫做sql的id--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- parameterType: 声明输入参数的类型--</span></span><br><span class="line"><span class="comment">    &lt;!-- parameterType: 声明输出结果的类型，应该填写pojo的全路径~ -&gt;</span></span><br><span class="line"><span class="comment">    &lt;!-- #&#123;&#125;: 输入参数的占位符，相当于jdbc的? --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">parameterType</span>= <span class="string">"int"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>=<span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">        SELECT * FROM `user` WHERE id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="测试程序"><a href="#测试程序" class="headerlink" title="测试程序"></a>测试程序</h3><p>测试程序步骤：</p>
<ol>
<li><p>创建 SqISessionFactoryBuilder 对象</p>
</li>
<li><p>加载SqlMapConfig.xml配置文件</p>
</li>
<li><p>创建 SqISessionFactory 对象</p>
</li>
<li><p>创建SqISession对象</p>
</li>
<li><p>执行SqISession对象执行查询，获取结果User</p>
</li>
<li><p>打印结果</p>
</li>
<li><p>释放资源</p>
</li>
</ol>
<p>MybatisTest编写测试程序如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> SqlSessionFactory sqlSessionFactory = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Before</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// 1.创建SqlSessionFactoryBuilder对象</span></span><br><span class="line">        SqlSessionF actoryBuilder sqlSessionFactoryBuilder = <span class="keyword">new</span> </span><br><span class="line">            SqlSessionFactoryBuilder();</span><br><span class="line">		<span class="comment">//2. 加载SqIMapConfig. xml配置文件</span></span><br><span class="line">		Inputstream inputstream =</span><br><span class="line">Resources.getResourceAsstream(<span class="string">"SqlMapConfig . xm1"</span>);</span><br><span class="line">		<span class="comment">// 3.创建SqlSessionFactory对象</span></span><br><span class="line">		<span class="keyword">this</span>.sqlSessionFactory =sqlSessionF actoryBuilder.build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">//4.创建SqlSession对象</span></span><br><span class="line">		Sq1Session sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">		<span class="comment">//5.执行SqlSession对象执行查询，获取结果User</span></span><br><span class="line">		<span class="comment">//第一个参数是User.xml的statement的id.第二个参数是执行sql需要的参数:</span></span><br><span class="line">		Object user = sqlSession.selectOne(<span class="string">"queryuserById"</span>,<span class="number">1</span>);</span><br><span class="line">		<span class="comment">//6.打印结果</span></span><br><span class="line">		System.out.println(user);</span><br><span class="line">        </span><br><span class="line">		<span class="comment">//7.释放资源</span></span><br><span class="line">		sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-1"><a href="#效果-1" class="headerlink" title="效果"></a>效果</h3><p>测试结果如下图</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568900350886.png"  alt="1568900350886"></p>
<h2 id="实现根据用户名模糊查询用户"><a href="#实现根据用户名模糊查询用户" class="headerlink" title="实现根据用户名模糊查询用户"></a>实现根据用户名模糊查询用户</h2><p>查询sql：</p>
<p>SELECT * FROM <code>user</code> WHERE username LIKE <code>％王％</code></p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><h4 id="映射文件-1"><a href="#映射文件-1" class="headerlink" title="映射文件"></a>映射文件</h4><p>在User.xml配置文件中添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--如果返回多个结果，mybatis会自动把返回的结果放在list容器中--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- resultType的配置和返回一个结果的配置样--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByUsername1"</span> <span class="attr">parameterType</span>= <span class="string">"string"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">resultType</span>= <span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">	SELECT * FROM `user` WHERE username LIKE #&#123;username&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="测试程序-1"><a href="#测试程序-1" class="headerlink" title="测试程序"></a>测试程序</h4><p>MybatisTest中添加测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByusername1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//4.创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">	<span class="comment">//5.执行SqlSession对象执行查询，获取结果User</span></span><br><span class="line">	<span class="comment">//查询多条数据使用selectlist方法</span></span><br><span class="line">	List&lt;object&gt; list =sq1Session.selectList(<span class="string">"queryUserByUsername1"</span>,<span class="string">"%王%"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//6.打印结果</span></span><br><span class="line">    <span class="keyword">for</span> (Object user : list) &#123;</span><br><span class="line">    	System. out. println(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//7.释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果-2"><a href="#效果-2" class="headerlink" title="效果"></a>效果</h4><p>测试效果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568900864995.png"  alt="1568900864995"></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><h4 id="映射文件-2"><a href="#映射文件-2" class="headerlink" title="映射文件"></a>映射文件</h4><p>在User.xml配置文件中添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--如果传入的参数是简单数据类型，$&#123;&#125;里面必须写value --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByUsername2"</span> <span class="attr">parameterType</span>= <span class="string">"string"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">resultType</span>= <span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">	SELECT * FROM `user` WHERE username LIKE '%$&#123;value&#125;%'</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="测试程序-2"><a href="#测试程序-2" class="headerlink" title="测试程序"></a>测试程序</h4><p>MybatisTest中添加测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUuserByUsername2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//4.创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//5.执行SqlSession对象执行查询，获取结果User</span></span><br><span class="line">    <span class="comment">//查询多条数据使用selectlist方法</span></span><br><span class="line">    List&lt;Object&gt; list = sqlSession.selectlist(<span class="string">"queryUserByUsername2"</span>,<span class="string">"王"</span>);</span><br><span class="line">    <span class="comment">//6.打印结果</span></span><br><span class="line">    <span class="keyword">for</span> (Object user : list) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 7.释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="效果-3"><a href="#效果-3" class="headerlink" title="效果"></a>效果</h4><p>测试结果如下图：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568901165329.png"  alt="1568901165329"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><h3 id="和"><a href="#和" class="headerlink" title="#{}和${}"></a>#{}和${}</h3><p>#{}表示一个占位符号，通过#{}可以实现preparedStatement向占位符中设置值，自动进行java类型和jdbc类型转换。#{}可以有效防止sql注入。#{}可以接收简 单类型值或pojo属性值。如果parameterType传输单个简单类型值，#{}括号中 可以是value或其它名称。</p>
<p>${}表示拼接sql串，通过${}可以将parameterType传入的内容拼接在sql中且不 进行jdbc类型转换，${}可以接收简单类型值或pojo属性值，如果parameterType 传输单个简单类型值，${}括号中只能是value。</p>
<h3 id="parameterType-和-resultType"><a href="#parameterType-和-resultType" class="headerlink" title="parameterType 和 resultType"></a>parameterType 和 resultType</h3><p>parameterType：指定输入参数类型，mybatis通过ognl从输入对象中获取参数值 拼接在sql中。</p>
<p>resultType：指定输出结果类型，mybatis将sql查询结果的一行记录数据映射为 resultType指定类型的对象。如果有多条数据，则分别进行映射，并把对象放到 容器List中</p>
<h3 id="selectOne-和-selectList"><a href="#selectOne-和-selectList" class="headerlink" title="selectOne 和 selectList"></a>selectOne 和 selectList</h3><p>selectOne查询一条记录，如果使用selectOne查询多条记录则抛出异常：</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568901299558.png"  alt="1568901299558"></p>
<p>selectList可以查询一条或多条记录。</p>
<h2 id="实现添加用户"><a href="#实现添加用户" class="headerlink" title="实现添加用户"></a>实现添加用户</h2><p>使用的sql：</p>
<p>INSERT INTO <code>user</code> (username,birthday.sex,address) VALUES (‘黄忠’,’2016-07-26’,’1’,’三国’)</p>
<h3 id="映射文件-3"><a href="#映射文件-3" class="headerlink" title="映射文件"></a>映射文件</h3><p>在User.xml配置文件中添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--保存用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>= <span class="string">"saveUser"</span> <span class="attr">parameterType</span>= <span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">    INSERT INTO `user`</span><br><span class="line">    (username,birthday,sex,address) VALUES</span><br><span class="line">    (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="测试程序-3"><a href="#测试程序-3" class="headerlink" title="测试程序"></a>测试程序</h3><p>MybatisTest中添加测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//4.创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//5.执行SqlSession对象执行保存</span></span><br><span class="line">    <span class="comment">//创建需要保存的User</span></span><br><span class="line">    User user = <span class="keyword">new</span> user();</span><br><span class="line">    user.setUsername(<span class="string">"张飞"</span>);</span><br><span class="line">    user.setSex(<span class="string">"1"</span>);</span><br><span class="line">    user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">    user.setAddress(<span class="string">"蜀国"</span>);</span><br><span class="line">    sqlSession.insert(<span class="string">"saveUser"</span>,user);</span><br><span class="line">    System.out.print1n(user);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//需要进行事务提交</span></span><br><span class="line">    sqlSession.commit();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//7.释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-4"><a href="#效果-4" class="headerlink" title="效果"></a>效果</h3><p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568901692616.png"  alt="1568901692616"></p>
<p>如上所示，保存成功，但是id=O,需要解决id返回不正常的问题。</p>
<h3 id="mysql自增主键返回"><a href="#mysql自增主键返回" class="headerlink" title="mysql自增主键返回"></a>mysql自增主键返回</h3><p>查询id的sql</p>
<p>SELECT LASTJNSERT_ID()</p>
<p>通过修改User.xml映射文件，可以将mysql自增主键返回：</p>
<p>如下添加selectKey标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--保存用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"saveUser"</span> <span class="attr">parameterType</span>=<span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- selectKey 标签实现主键返回--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- keyColumn: 主键对应的表中的哪一列--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- keyProperty: 主键对应的pojo中的哪一个属性--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- order:设置在执行insert语句前执行查询id的sql,孩纸在执行insert语句之后执行查询id的sql--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- resultType: 设置返回的id的类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyColumn</span>=<span class="string">"id"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span> <span class="attr">resultType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        SELECT LAST INSERT ID()</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectkey</span>&gt;</span></span><br><span class="line">    INSERT INTO `user`</span><br><span class="line">    (username,birthday,sex,address) VALUES</span><br><span class="line">    (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>LAST_INSERT_ID():是 mysql 的函数，返回 auto_increment 自增列新记录 id 值。</p>
<p>效果如下图所示:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568901894969.png"  alt="1568901894969"></p>
<p>返回的id为48,能够正确的返回id 了。</p>
<h3 id="Mysql使用uuid实现主键"><a href="#Mysql使用uuid实现主键" class="headerlink" title="Mysql使用uuid实现主键"></a>Mysql使用uuid实现主键</h3><p>需要增加通过select uuid()得到uuid值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--保存用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"saveUser"</span> <span class="attr">parameterType</span>=<span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- selectKey 标签实现主键返回--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- keyColumn: 主键对应的表中的哪列--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- keyProperty:主键对应的pojo中的哪一个属性 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- order:设置在执行insert语句前执行查询id的sql.孩纸在执行insert语句之后执行查询id的sql--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- resultType: 设置返回的id的类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyColumn</span>=<span class="string">"id"</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">order</span>=<span class="string">"BEFORE"</span></span></span><br><span class="line"><span class="tag">    	<span class="attr">resultType</span>= <span class="string">"string"</span>&gt;</span></span><br><span class="line">    	SELECT LAST_INSERT ID()</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectkey</span>&gt;</span></span><br><span class="line">    INSERT INTO `user`</span><br><span class="line">    (username,birthday,sex,address) VALUES</span><br><span class="line">    (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意这里使用的order是‘’BEFORE”</p>
<h2 id="修改用户"><a href="#修改用户" class="headerlink" title="修改用户"></a>修改用户</h2><p>根据用户id修改用户名</p>
<p>使用的sql：</p>
<p>UPDATE <code>user</code> SET username =’赵云’ WHERE id = 26</p>
<h3 id="映射文件-4"><a href="#映射文件-4" class="headerlink" title="映射文件"></a>映射文件</h3><p>在User.xml配置文件中添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--更新用户--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>= <span class="string">"updateUserById"</span> <span class="attr">parameterType</span>= <span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">UPDATE `user` SET username = #&#123;username&#125; WHERE id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="测试程序-4"><a href="#测试程序-4" class="headerlink" title="测试程序"></a>测试程序</h3><p>MybatisTest中添加测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 4.创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 5.执行SqlSession对象执行更新</span></span><br><span class="line">    <span class="comment">//创建需要更新的User</span></span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">26</span>);</span><br><span class="line">    user.setUsername(<span class="string">"关羽"</span>);</span><br><span class="line">    user.setSex(<span class="string">"1"</span>);</span><br><span class="line">    user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">    user.setAddress(<span class="string">"蜀国"</span>);</span><br><span class="line">    </span><br><span class="line">    sqlSession.update(<span class="string">"updateUserById"</span>,user);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//需要进行事务提交</span></span><br><span class="line">    sqlSession.commit();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 7.释放资源</span></span><br><span class="line">    sqlsession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-5"><a href="#效果-5" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568902492020.png"  alt="1568902492020"></p>
<h2 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h2><p>根据用户id删除用户</p>
<p>使用的sql</p>
<p>DELETE FROM <code>user</code> WHERE id = 47</p>
<h3 id="映射文件-5"><a href="#映射文件-5" class="headerlink" title="映射文件"></a>映射文件</h3><p>在User.xml配置文件中添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--删除用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">	delete from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="测试程序-5"><a href="#测试程序-5" class="headerlink" title="测试程序"></a>测试程序</h3><p>MybatisTest中添加测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//4.创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">    <span class="comment">//5.执行SqlSession对象执行删除</span></span><br><span class="line">    sqlSession.delete(<span class="string">"deleteUserById"</span>,<span class="number">48</span>);</span><br><span class="line">    <span class="comment">//需要进行事务提交</span></span><br><span class="line">    sqlSession.commit();</span><br><span class="line">    <span class="comment">// 7.释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="效果-6"><a href="#效果-6" class="headerlink" title="效果"></a>效果</h3><p>测试效果如下图:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568902675130.png"  alt="1568902675130"></p>
<h2 id="Mybatis解决jdbc编程的问题"><a href="#Mybatis解决jdbc编程的问题" class="headerlink" title="Mybatis解决jdbc编程的问题"></a>Mybatis解决jdbc编程的问题</h2><p>1、数据库连接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用 数据库连接池可解决此问题。</p>
<p>解决：在SqlMapConfig.xml中配置数据连接池，使用连接池管理数据库链接。</p>
<p>2、Sql语句写在代码中造成代码不易维护，实际应用sql变化的可能较大，sql 变动需要改变java代码。</p>
<p>解决：将Sql语句配置在XXXXmapper.xml文件中与java代码分离。</p>
<p>3、向sql语句传参数麻烦，因为sql语句的where条件不一•定，可能多也可能 少，占位符需要和参数一一对应。</p>
<p>解决：Mybatis自动将java对象映射至sql语句，通过statement中的 parameterType定义输入参数的类型。</p>
<p>4、对结果集解析麻烦，sql变化导致解析代码变化，且解析前需要遍历，如果 能将数据库记录封装成pojo对象解析比较方便。</p>
<p>解决：Mybatis自动将sql执行结果映射至java对象，通过statement中的 resultType定义输出结果的类型。</p>
<h2 id="mybatis-与-hibernate-不同"><a href="#mybatis-与-hibernate-不同" class="headerlink" title="mybatis 与 hibernate 不同"></a>mybatis 与 hibernate 不同</h2><p>Mybatis和hibernate不同，它不完全是一个0RM框架，因为 MyBatis需要 程序员自己编写Sql语句o mybatis可以通过XML或注解方式灵活配置要运行的 sql语句，并将java对象和sql语句映射生成最终执行的sql,最后将sql执行的 结果再映射生成java对象。</p>
<p>Mybatis学习门槛低，简单易学，程序员直接编写原生态sql,可严格控制sql 执行性能，灵活度高，非常适合对关系数据模型要求不高的软件开发，例如互联 网软件、企业运营类软件等，因为这类软件需求变化频繁，一但需求变化要求成 果输岀迅速。但是灵活的前提是mybatis无法做到数据库无关性，如果需要实现 支持多种数据库的软件则需要自定义多套sql映射文件，工作量大。</p>
<p>Hibernate对象/关系映射能力强，数据库无关性好，对于关系模型要求高的 软件（例如需求固定的定制化软件）如果用hibernate开发可以节省很多代码， 提高效率。但是Hibernate的学习门槛高，要精通门槛更高，而且怎么设计0/R 映射，在性能和对象模型之间如何权衡，以及怎样用好Hibernate需要具有很强 的经验和能力才行。</p>
<p>总之，按照用户的需求在有限的资源环境下只要能做出维护性、扩展性良好 的软件架构都是好架构，所以框架只有适合才是最好。</p>
<h1 id="Dao开发方法"><a href="#Dao开发方法" class="headerlink" title="Dao开发方法"></a>Dao开发方法</h1><p>使用MyBatis开发Dao,通常有两个方法，即原始Dao开发方法和Mapper 动态代理开发方法。</p>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>使用MyBatis开发DAO实现以下的功能：</p>
<p>根据用户id查询一个用户信息</p>
<p>根据用户名称模糊查询用户信息列表</p>
<p>添加用户信息</p>
<h2 id="SqISession的使用范围"><a href="#SqISession的使用范围" class="headerlink" title="SqISession的使用范围"></a>SqISession的使用范围</h2><p>SqISession中封装了对数据库的操作，如：查询、插入、更新、删除等。</p>
<p>SqISession 通过 SqISessionFactory 创建。</p>
<p>SqISessionFactory 是通过 SqISessionFactoryBuilder 进行创建。</p>
<h3 id="SqISessionFactoryBuilder"><a href="#SqISessionFactoryBuilder" class="headerlink" title="SqISessionFactoryBuilder"></a>SqISessionFactoryBuilder</h3><p>SqISessionFactoryBuilder 用于创建 SqISessionFacoty, SqISessionFacoty 一旦创建完成就不需要 SqISessionFactoryBuilder 了，因为 SqISession 是通过 SqISessionFactory创建的。所以可以将SqISessionFactoryBuilder当成一个工具类使用，最佳使用范围是方法范围即方法体内局部变量。</p>
<h3 id="SqISessionFactory"><a href="#SqISessionFactory" class="headerlink" title="SqISessionFactory"></a>SqISessionFactory</h3><p>SqISessionFactory是一个接口，接口中定义了 openSession的不同重载方法，SqISessionFactory的最佳使用范围是整个应用运行期间，一旦创建后可以重复使 用,通常以单例模式管理SqlSessionFactory0</p>
<h3 id="SqISession"><a href="#SqISession" class="headerlink" title="SqISession"></a>SqISession</h3><p>SqISession是一个面向用户的接口，sqISession中定义了数据库操作方法。</p>
<p>每个线程都应该有它自己的SqISession实例。SqISession的实例不能共享使 用，它也是线程不安全的。因此最佳的范围是请求或方法范围。绝对不能将 SqISession实例的引用放在一个类的静态字段或实例字段中。</p>
<p>打开一个SqISession；使用完毕就要关闭它。通常把这个关闭操作放到finally 块中以确保每次都能执行关闭。如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="comment">//do work</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">	session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="原始Dao开发方式"><a href="#原始Dao开发方式" class="headerlink" title="原始Dao开发方式"></a>原始Dao开发方式</h2><p>原始Dao开发方法需要程序员编写Dao接口和Dao实现类。</p>
<h3 id="映射文件-6"><a href="#映射文件-6" class="headerlink" title="映射文件"></a>映射文件</h3><p>编写映射文件如下：(也可以使用入门程序完成的映射文件)    </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=".0" encoding= "UTF-8 ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.8//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace: 命名空间，用于隔离sql, 还有个很重要的作用，后面会讲--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>= <span class="string">"test"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>=<span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--根据username模糊查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>= <span class="string">"queryUserByUsername"</span> <span class="attr">parameterType</span>=<span class="string">"string"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">resultType</span>= <span class="string">"cn.itcast.mybatis.pojo.User"</span>&gt;</span></span><br><span class="line">        select * from user where username like '%$&#123;value&#125;%'</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">--保存用户--</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>= <span class="string">"saveUser"</span> <span class="attr">parameterType</span>= <span class="string">"cn.itcast.mybatis.pojo.user"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">keyColumn</span>=<span class="string">"id"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>= <span class="string">"int"</span>&gt;</span></span><br><span class="line">            SELECT LAST_INSERT_ID()</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into user(username,birthday,sex,address)</span><br><span class="line">        values(#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Dao-接口"><a href="#Dao-接口" class="headerlink" title="Dao 接口"></a>Dao 接口</h3><p>先进行DAO的接口开发，编码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据id查询用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据用户名模糊查询用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">queryUserByUsername</span> <span class="params">(String username)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *保存用户</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dao实现类"><a href="#Dao实现类" class="headerlink" title="Dao实现类"></a>Dao实现类</h3><p>编写的Dao实现类如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDaoImpl</span><span class="params">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.sqlSessionFactory = sqlSessionFactory;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建SqlSession</span></span><br><span class="line">    SqlSession sqlSession = <span class="keyword">this</span>. sqlSessionFactory . openSession();</span><br><span class="line">    <span class="number">1</span>/执行查询逻辑</span><br><span class="line">    User user = sqlSession. selectone(<span class="string">"queryuserById"</span>, id);</span><br><span class="line">    <span class="comment">//释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">queryUserByUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建Sq1Session</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//执行查询逻辑</span></span><br><span class="line">        List&lt;User&gt; list = sqlSession.selectlist( <span class="string">"queryuserByUsername"</span>，username);</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        sqlsession.close();</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveuser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建SqlSession</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//执行保存逻辑</span></span><br><span class="line">        sqlSession.insert(<span class="string">"saveUser"</span>,user);</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        <span class="comment">//释放资源</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dao-测试"><a href="#Dao-测试" class="headerlink" title="Dao 测试"></a>Dao 测试</h3><p>创建一个JUnit的测试类，对UserDao进行测试，测试代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//创建Sq1SessionF actoryBuilder</span></span><br><span class="line">        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        <span class="comment">//加载Sq1MapConfig.xml配置文件</span></span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(<span class="string">"Sq1MapConfig.xml"</span>);</span><br><span class="line">        <span class="comment">//创建SqlsessionFactory</span></span><br><span class="line">        <span class="keyword">this</span>.sqlSessionFactory = sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建DAO</span></span><br><span class="line">        UserDao userDao = <span class="keyword">new</span> UserDaoImpl(<span class="keyword">this</span>.sqlSessionFactory);</span><br><span class="line">        <span class="comment">//执行查询</span></span><br><span class="line">        User user = userDao.queryUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建DAO</span></span><br><span class="line">        UserDao userDao = <span class="keyword">new</span> UserDaoImpl (<span class="keyword">this</span>.sqlSessionFactory);</span><br><span class="line">        <span class="comment">//执行查询</span></span><br><span class="line">        List&lt;User&gt; list = userDao.queryuserByUsername(<span class="string">"张"</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">        System. out. println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//创建DAO</span></span><br><span class="line">        UserDao userDao = <span class="keyword">new</span> UserDaoImpl(<span class="keyword">this</span>.sqlSessionFactory);</span><br><span class="line">        <span class="comment">//创建保存对象</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">"刘备"</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        user.setSex(<span class="string">"1"</span>);</span><br><span class="line">        user.setAddress(<span class="string">"蜀国"</span>);</span><br><span class="line">        <span class="comment">//执行保存</span></span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">        System.out.print1n(user);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>原始Dao开发中存在以下问题：</p>
<p>♦ Dao方法体存在重复代码：通过SqISessionFactory创建SqISession,调用 SqISession的数据库操作方法</p>
<p>♦调用sqlSession的数据库操作方法需要指定statement的id,这里存在 硬编码，不得于开发维护。</p>
<h2 id="Mapper动态代理方式"><a href="#Mapper动态代理方式" class="headerlink" title="Mapper动态代理方式"></a>Mapper动态代理方式</h2><h3 id="开发规范"><a href="#开发规范" class="headerlink" title="开发规范"></a>开发规范</h3><p>Mapper接口开发方法只需要程序员编写Mapper接口（相当于Dao接口）， 由Mybatis框架根据接口定义创建接口的动态代理对象，代理对象的方法体同上 边Dao接口实现类方法。</p>
<p>Mapper接口开发需要遵循以下规范：</p>
<p>1、Mapper.xml文件中的namespace与mapper接口的类路径相同。</p>
<p>2、Mapper接口方法名和Mapper.xml中定义的每个statement的id相同</p>
<p>3、Mapper接口方法的输入参数类型和mapper.xml中定义的每个sql的 parameterType的类型相同</p>
<p>4、Mapper接口方法的输出参数类型和mapper.xml中定义的每个sql的 resultType的类型相同</p>
<h3 id="Mapper-xml（映射文件）"><a href="#Mapper-xml（映射文件）" class="headerlink" title="Mapper.xml（映射文件）"></a>Mapper.xml（映射文件）</h3><p>定义 mapper 映射文件 UserMapper.xml</p>
<p>将UserMapper.xml放在config F mapper目录下，效果如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN”</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"</span>http://mybatis.org/dtd/mybatis-3-mapper.dtd<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;!-- namespace: 命名空间，用于隔离sql --&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;!--还有一个很重要的作用，使用动态代理开发DAO, 1. namespace必须和Mapper</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">接口类路径一致--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;mapper namespace= "</span>cn.itcast.mybatis.mapper.UserMapper<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--根据用户id查询用户--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!-- 2. id必须和Mapper接口方法名致--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!-- 3. parameterType必须和接口方法参数类型一致--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!-- 4. resultType必须和接口方法返回值类型致--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;select id="</span>queryUserById<span class="meta-string">" parameterType="</span>int<span class="meta-string">"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        resultType= "</span>cn.itcast.mybatis.pojo.User<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    	select * from user where id = #&#123;id&#125;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/select&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    </span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--根据用户名查询用户--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;select id="</span>queryUserByUsername<span class="meta-string">" parameterType="</span>string<span class="meta-string">"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        resultType="</span>cn.itcast.mybatis.pojo.User<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        select * from user where username like '%$&#123;value&#125;%'</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/select&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">                                                 </span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--保存用户--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;insert id="</span>saveUser<span class="meta-string">" parameterType="</span>cn.itcast.mybatis.pojo.User<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;selectKey keyProperty= "</span>id<span class="meta-string">" keyColumn= "</span>id<span class="meta-string">" order= "</span>AFTER<span class="meta-string">" resultType="</span>int<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            select last_insert_id()</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;/selectKey&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        insert into user(username,birthday,sex,address) values</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;);</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/insert&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;/mapper&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>6.4.3. UserMapper(接口文件)</p>
<p>创建UserMapper接口代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据id查询</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">User <span class="title">queryUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *根据用户名查询用户</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">queryUserByUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *保存用户</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="加载-UserMapper-xml-文件"><a href="#加载-UserMapper-xml-文件" class="headerlink" title="加载 UserMapper.xml 文件"></a>加载 UserMapper.xml 文件</h3><p>修改SqlMapConfig.xml文件，添加以下所示的内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--加载映射文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>= <span class="string">"sqlmap/user.xmL"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>= <span class="string">"mapper/UserMapper.xmL"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>6.4.5.测试</p>
<p>编写的测试方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//创建SqlSessionFactoryBuilder</span></span><br><span class="line">        SqlSessionFactoryBuilder sqlSessionFactoryBuilder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        <span class="comment">// 加载SqlMapConfig.xml配置文件</span></span><br><span class="line">        InputStream inputStream = Resources.getResourceAsstream( <span class="string">"SqlMapConfig.xm1"</span>);</span><br><span class="line">        <span class="comment">//创建SqlsessionFactory</span></span><br><span class="line">        <span class="keyword">this</span>.sqlSessionFactory = sqlSessionFactoryBuilder.build(inputstream);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取sqlSession, 和spring整合后由spring管理</span></span><br><span class="line">        SqlSessionsqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//从sqlsession中获取Mapper接口的代理对象</span></span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//执行查询方法</span></span><br><span class="line">        User user = userMapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//和spring整合后由spring管理</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryUserByUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取sqlSession,和spring整合后由spring管理</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.opensession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//从sqlsession中获取Mapper接口的代理对象</span></span><br><span class="line">        UserMapper userMapper = sqlsession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//执行查询方法</span></span><br><span class="line">        List&lt;User&gt; list = userMapper.queryUserByUsername(<span class="string">"张"</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : list) &#123;</span><br><span class="line">        System.out.printn(user);</span><br><span class="line">            </span><br><span class="line">        <span class="comment">//和spring整合后由spring管理</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取sqlSession, 和spring整合后由spring管理</span></span><br><span class="line">        SqlSession sqlSession = <span class="keyword">this</span>.sqlSessionFactory.openSession();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//从sqlSession中获取Mapper接口的代理对象</span></span><br><span class="line">        UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">//创建保存对象</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">"刘备"</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        user.setSex(<span class="string">"1"</span>);</span><br><span class="line">        user.setAddress(<span class="string">"蜀国"</span>);</span><br><span class="line">        <span class="comment">//执行查询方法</span></span><br><span class="line">        userMapper.saveuser(user);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//和spring整合后由spring管理</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><h4 id="♦-selectOne-和-selectList"><a href="#♦-selectOne-和-selectList" class="headerlink" title="♦ selectOne 和 selectList"></a>♦ selectOne 和 selectList</h4><p>动态代理对象调用 sqISession.selectOne（）和 sqISession.selectList。是根据 mapper 接口方法的返回值决定，如果返回list则调用selectList方法，如果返回单个对象 则调用selectOne方法。</p>
<h4 id="♦-namespace"><a href="#♦-namespace" class="headerlink" title="♦ namespace"></a>♦ namespace</h4><p>mybatis官方推荐使用mapper代理方法开发mapper接口，程序员不用编写 mapper接口实现类，使用mapper代理方法时，输入参数可以使用poj。包装对 象或map对象，保证dao的通用性。</p>
<h1 id="SqlMapConfig-xml-配置文件"><a href="#SqlMapConfig-xml-配置文件" class="headerlink" title="SqlMapConfig.xml 配置文件"></a>SqlMapConfig.xml 配置文件</h1><h2 id="配置内容"><a href="#配置内容" class="headerlink" title="配置内容"></a>配置内容</h2><p>SqlMapConfig.xml中配置的内容和顺序如下：</p>
<p>properties（属性）</p>
<p>settings（全局配置参数）</p>
<p>typeAliases（类型别名）</p>
<p>typeHandlers（类型处理器）</p>
<p>object Factory（对象工厂）</p>
<p>plugins（插件）</p>
<p>environments（环境集合属性对象）</p>
<p>​    environment（环境子属性对象）</p>
<p>​        transactionManager（事务管理）</p>
<p>​            dataSource（数据源）</p>
<p>mappers（映射器）</p>
<h2 id="properties（属性）"><a href="#properties（属性）" class="headerlink" title="properties（属性）"></a>properties（属性）</h2><p>SqlMapConfig.xml可以引用java属性文件中的配置信息如下:</p>
<p>在config下定义db.properties文件，如下所示:</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568905323910.png"  alt="1568905323910"></p>
<p>db.properties配置文件内容如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?characterEncoding =utf-8</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>SqlMapConfig.xml 引用如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--是用resource属性加载外部配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.propertie"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--在properties内部用property定义属性--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果外部配置文件有该属性，则内部定义属性被外部属性覆盖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"jdbc.username"</span> <span class="attr">value</span>=<span class="string">"roo123"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>= <span class="string">"jdbc.password"</span> <span class="attr">value</span>=<span class="string">"root123"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--和spring整合后environments 配置将废除--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>= <span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>= <span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--使用jdbc事务管理--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--数据库连接池--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>= <span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"urL"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.urL&#125;"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--加载映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>= <span class="string">"sqlmap/User.xmL"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>= <span class="string">"mapper/UserMapper.xmL"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：MyBatis将按照下面的顺序来加载属性：</p>
<p>♦在properties元素体内定义的属性首先被读取。</p>
<p>♦然后会读取properties元素中resource或url加载的属性，它会覆盖已读取</p>
<p>的同名属性。</p>
<h2 id="typeAliases（类型别名）"><a href="#typeAliases（类型别名）" class="headerlink" title="typeAliases（类型别名）"></a>typeAliases（类型别名）</h2><h3 id="mybatis-支持别名"><a href="#mybatis-支持别名" class="headerlink" title="mybatis 支持别名"></a>mybatis 支持别名</h3><table>
<thead>
<tr>
<th>别名</th>
<th>映射的类型</th>
</tr>
</thead>
<tbody><tr>
<td>_byte</td>
<td>byte</td>
</tr>
<tr>
<td>_Jong</td>
<td>long</td>
</tr>
<tr>
<td>_short</td>
<td>short</td>
</tr>
<tr>
<td>_int</td>
<td>int</td>
</tr>
<tr>
<td>_integer</td>
<td>int</td>
</tr>
<tr>
<td>_double</td>
<td>double</td>
</tr>
<tr>
<td>_float</td>
<td>float</td>
</tr>
<tr>
<td>_boolean</td>
<td>boolean</td>
</tr>
<tr>
<td>string</td>
<td>String</td>
</tr>
<tr>
<td>byte</td>
<td>Byte</td>
</tr>
<tr>
<td>long</td>
<td>Long</td>
</tr>
<tr>
<td>short</td>
<td>Short</td>
</tr>
<tr>
<td>int</td>
<td>Integer</td>
</tr>
<tr>
<td>integer</td>
<td>integer</td>
</tr>
<tr>
<td>double</td>
<td>Double</td>
</tr>
<tr>
<td>float</td>
<td>Float</td>
</tr>
<tr>
<td>boolean</td>
<td>Boolean</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
</tr>
<tr>
<td>decimal</td>
<td>BigDecimal</td>
</tr>
<tr>
<td>bigdecimal</td>
<td>Bigdecimal</td>
</tr>
<tr>
<td>map</td>
<td>Map</td>
</tr>
</tbody></table>
<h3 id="自定义别名"><a href="#自定义别名" class="headerlink" title="自定义别名"></a>自定义别名</h3><p>在SqlMapConfig.xml中配置如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version-"1.9" encoding= "UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN”</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"</span>http://mybatis.org/dtd/mybatis-3-config.dtd<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;configuration&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--是用resource属性加载外部配置文件--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;properties resource= "</span>db.properties<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;!--在properties内部用property定义属性--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;property name= "</span>jdbc.username<span class="meta-string">" value="</span>root123<span class="meta-string">"/&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;property name= "</span>jdbc.password<span class="meta-string">" value="</span>root123<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/properties&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string"></span></span></span><br><span class="line"><span class="meta"><span class="meta-string">   &lt;typeAliases&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">		&lt;!-- 单个别名定义 --&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">		&lt;typeAlias alias="</span>user<span class="meta-string">" type="</span>com.itheima.mybatis.pojo.User<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">		&lt;!-- 别名包扫描器(推荐使用此方式)，整个包下的类都被定义别名，别名为类名，不区分大小写--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">		&lt;package name="</span>com.itheima.mybatis.pojo<span class="meta-string">"/&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">       	&lt;package name="</span>其他包<span class="meta-string">"/&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">	&lt;/typeAliases&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    </span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--和spring整合后environments配置将废除--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;environments default="</span>development<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;environment id="</span>development<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            &lt;!--使用jdbc事务管理--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            &lt;transactionManager type="</span>JDBC<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            &lt;!--数据库连接池--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            &lt;dataSource type="</span>POOLED<span class="meta-string">"&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">                &lt;property name="</span>driver<span class="meta-string">" value="</span>$&#123;jdbc.driver&#125;<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">                &lt;property name="</span>url<span class="meta-string">" value="</span>$&#123;jdbc.url&#125;<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">                &lt;property name="</span>username<span class="meta-string">" value="</span>$&#123;jdbc.username&#125;<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">                &lt;property name="</span>password<span class="meta-string">" value="</span>$&#123;jdbc.password&#125;<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">            &lt;/dataSource&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;/environment&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/environments&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    </span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;!--加载映射文件--&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;mappers&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;mapper resource= "</span>sqlmap/User.xmL<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">        &lt;mapper resource= "</span>mapper/UserMapper.xmL<span class="meta-string">" /&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">    &lt;/mappers&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&lt;/configuration&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>在mapper.xml配置文件中，就可以使用设置的别名了</p>
<p>别名大小写不敏感</p>
<p><img src="/" class="lazyload" data-src="C:%5CUsers%5Czxq%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1568907171536.png"  alt="1568907171536"></p>
<h2 id="mappers（映射器）"><a href="#mappers（映射器）" class="headerlink" title="mappers（映射器）"></a>mappers（映射器）</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Mapper配置的几种方法：</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">" "</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">使用相对于类路径的资源（现在的使用方式） 如:<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"sqlmap/User.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">" "</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">使用mapper接口类路径</span><br><span class="line"></span><br><span class="line">如：<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"cn.itcast.mybatis.mapper.UserMapper"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">注意：此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中。</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">注册指定包下的所有mapper接口</span><br><span class="line"></span><br><span class="line">如：<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.itcast.mybatis.mapper"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">注意：此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中。</span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Reddes</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://reddescode.github.io/2019/09/17/MyBatis01/">http://reddescode.github.io/2019/09/17/MyBatis01/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://ReddesCode.github.io" target="_blank">Reddes的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MyBatis01/">MyBatis01</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/09/17/http%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">http协议简介</div></div></a></div><div class="next-post pull_right"><a href="/2019/09/17/MyBatis02/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MyBatis02</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'f31J5kVi0JdGq11UOxhQJ12Y-gzGzoHsz',
  appKey: 'urv1VlxqDU3Naidx9UGV9zmW',
  notify: true,
  verify: true,
  placeholder: '写点什么。。',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Reddes</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>